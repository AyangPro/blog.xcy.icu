<!DOCTYPE html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-beta.61" />
    <meta name="theme" content="VuePress Theme Hope" />
    <link rel="icon" href="https://jklk-1304336794.cos.ap-nanjing.myqcloud.com/default/icon/icon.png"><title>SpringCloud</title><meta name="description" content="CY">
    <style>
      :root {
        --bg-color: #fff;
      }

      html[data-theme="dark"] {
        --bg-color: #1d1e1f;
      }

      html,
      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <link rel="preload" href="/assets/style-ff3b8345.css" as="style"><link rel="stylesheet" href="/assets/style-ff3b8345.css">
    <link rel="modulepreload" href="/assets/app-40618983.js"><link rel="modulepreload" href="/assets/framework-91490e6a.js"><link rel="modulepreload" href="/assets/SpringCloud.html-fb3c917d.js"><link rel="modulepreload" href="/assets/SpringCloud.html-ca363390.js">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="skip-link sr-only">è·³è‡³ä¸»è¦å…§å®¹</a><!--]--><!--[--><div class="theme-container has-toc"><!--[--><header class="navbar" id="navbar"><div class="navbar-start"><button class="toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><!----><!--]--><a href="/" class="brand"><img class="logo" src="https://jklk-1304336794.cos.ap-nanjing.myqcloud.com/default/logo/logo.png" alt><!----><!----></a><!--[--><!----><!--]--></div><div class="navbar-center"><!--[--><!----><!--]--><nav class="nav-links"><div class="nav-item hide-in-mobile"><a href="/" class="nav-link" aria-label="ä¸»é¡µ"><span class="font-icon icon iconfont icon-iconfont icon-home-fill" style=""></span>ä¸»é¡µ<!----></a></div><div class="nav-item hide-in-mobile"><a href="/md/interview/" class="nav-link" aria-label="é¢è¯•"><span class="font-icon icon iconfont icon-iconfont icon-mianshi" style=""></span>é¢è¯•<!----></a></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="Java"><span class="title"><span class="font-icon icon iconfont icon-iconfont icon-java1" style=""></span>Java</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>Java åŸºç¡€</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/md/java/basic/java-basic-oop.html" class="nav-link" aria-label="Java é¢å‘å¯¹è±¡"><!---->Java é¢å‘å¯¹è±¡<!----></a></li><li class="dropdown-subitem"><a href="/md/java/basic/java-basic-lan.html" class="nav-link" aria-label="Java åŸºç¡€çŸ¥è¯†"><!---->Java åŸºç¡€çŸ¥è¯†<!----></a></li></ul></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>Java IO</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/md/java/io/java-io.html" class="nav-link" aria-label="Java IO "><!---->Java IO <!----></a></li></ul></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>Java åå°„</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/md/java/reflect/java-reflect.html" class="nav-link" aria-label="Java åå°„ "><!---->Java åå°„ <!----></a></li></ul></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>Java é›†åˆ</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/md/java/collection/java-collection.html" class="nav-link" aria-label="Java é›†åˆæ¡†æ¶"><!---->Java é›†åˆæ¡†æ¶<!----></a></li></ul></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="æ•°æ®åº“"><span class="title"><span class="font-icon icon iconfont icon-iconfont icon-shujuku1" style=""></span>æ•°æ®åº“</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>æ•°æ®åº“åŸºç¡€</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/md/db/sql/sql-db.html" class="nav-link" aria-label="æ•°æ®åº“åŸç†"><!---->æ•°æ®åº“åŸç†<!----></a></li><li class="dropdown-subitem"><a href="/md/db/sql/sql-lan.html" class="nav-link" aria-label="SQLè¯­è¨€"><!---->SQLè¯­è¨€<!----></a></li></ul></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>SQLæ•°æ®åº“</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/md/db/sql-mysql/sql-mysql-overview.html" class="nav-link" aria-label="MySQL"><!---->MySQL<!----></a></li></ul></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>NoSQLæ•°æ®åº“</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/md/db/nosql-redis/sql-redis-overview.html" class="nav-link" aria-label="Redis"><!---->Redis<!----></a></li></ul></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="Spring"><span class="title"><span class="font-icon icon iconfont icon-iconfont icon-leaf1" style=""></span>Spring</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>Spring çŸ¥è¯†ä½“ç³»</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/md/spring/spring.html" class="nav-link" aria-label="Spring Framework"><!---->Spring Framework<!----></a></li><li class="dropdown-subitem"><a aria-current="page" href="/md/spring/SpringCloud.html" class="router-link-active router-link-exact-active nav-link active" aria-label="Spring Cloud"><!---->Spring Cloud<!----></a></li></ul></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="æ¡†æ¶"><span class="title"><span class="font-icon icon iconfont icon-iconfont icon-mn_kuangjia_fill" style=""></span>æ¡†æ¶</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>ORMæ¡†æ¶</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/md/framework/orm-mybatis/mybatis-overview.html" class="nav-link" aria-label="Mybatis"><!---->Mybatis<!----></a></li></ul></li></ul></button></div></div><div class="nav-item hide-in-mobile"><a href="/about-me.html" class="nav-link" aria-label="å…³äºä½œè€…"><span class="font-icon icon iconfont icon-iconfont icon-aboutme" style=""></span>å…³äºä½œè€…<!----></a></div></nav><!--[--><!----><!--]--></div><div class="navbar-end"><!--[--><!----><!--]--><!----><!----><div class="nav-item hide-in-mobile"><button class="outlook-button" tabindex="-1" ariahidden="true"><svg xmlns="http://www.w3.org/2000/svg" class="icon outlook-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="outlook icon"><path d="M224 800c0 9.6 3.2 44.8 6.4 54.4 6.4 48-48 76.8-48 76.8s80 41.6 147.2 0 134.4-134.4 38.4-195.2c-22.4-12.8-41.6-19.2-57.6-19.2C259.2 716.8 227.2 761.6 224 800zM560 675.2l-32 51.2c-51.2 51.2-83.2 32-83.2 32 25.6 67.2 0 112-12.8 128 25.6 6.4 51.2 9.6 80 9.6 54.4 0 102.4-9.6 150.4-32l0 0c3.2 0 3.2-3.2 3.2-3.2 22.4-16 12.8-35.2 6.4-44.8-9.6-12.8-12.8-25.6-12.8-41.6 0-54.4 60.8-99.2 137.6-99.2 6.4 0 12.8 0 22.4 0 12.8 0 38.4 9.6 48-25.6 0-3.2 0-3.2 3.2-6.4 0-3.2 3.2-6.4 3.2-6.4 6.4-16 6.4-16 6.4-19.2 9.6-35.2 16-73.6 16-115.2 0-105.6-41.6-198.4-108.8-268.8C704 396.8 560 675.2 560 675.2zM224 419.2c0-28.8 22.4-51.2 51.2-51.2 28.8 0 51.2 22.4 51.2 51.2 0 28.8-22.4 51.2-51.2 51.2C246.4 470.4 224 448 224 419.2zM320 284.8c0-22.4 19.2-41.6 41.6-41.6 22.4 0 41.6 19.2 41.6 41.6 0 22.4-19.2 41.6-41.6 41.6C339.2 326.4 320 307.2 320 284.8zM457.6 208c0-12.8 12.8-25.6 25.6-25.6 12.8 0 25.6 12.8 25.6 25.6 0 12.8-12.8 25.6-25.6 25.6C470.4 233.6 457.6 220.8 457.6 208zM128 505.6C128 592 153.6 672 201.6 736c28.8-60.8 112-60.8 124.8-60.8-16-51.2 16-99.2 16-99.2l316.8-422.4c-48-19.2-99.2-32-150.4-32C297.6 118.4 128 291.2 128 505.6zM764.8 86.4c-22.4 19.2-390.4 518.4-390.4 518.4-22.4 28.8-12.8 76.8 22.4 99.2l9.6 6.4c35.2 22.4 80 12.8 99.2-25.6 0 0 6.4-12.8 9.6-19.2 54.4-105.6 275.2-524.8 288-553.6 6.4-19.2-3.2-32-19.2-32C777.6 76.8 771.2 80 764.8 86.4z"></path></svg><div class="outlook-dropdown"><!----></div></button></div><!--[--><button class="search-pro-button" role="search" aria-label="æœç´¢"><svg xmlns="http://www.w3.org/2000/svg" class="icon search-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="search icon"><path d="M192 480a256 256 0 1 1 512 0 256 256 0 0 1-512 0m631.776 362.496-143.2-143.168A318.464 318.464 0 0 0 768 480c0-176.736-143.264-320-320-320S128 303.264 128 480s143.264 320 320 320a318.016 318.016 0 0 0 184.16-58.592l146.336 146.368c12.512 12.48 32.768 12.48 45.28 0 12.48-12.512 12.48-32.768 0-45.28"></path></svg><div class="placeholder">æœç´¢</div><div class="key-hints"><kbd class="key">Ctrl</kbd><kbd class="key">K</kbd></div></button><!--]--><!--[--><!----><!--]--><button class="toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span class="button-container"><span class="button-top"></span><span class="button-middle"></span><span class="button-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside class="sidebar" id="sidebar"><!--[--><!----><!--]--><ul class="sidebar-links"><li><!--[--><a href="/md/interview/" class="nav-link sidebar-link sidebar-page" aria-label="ç›®å½•"><!---->ç›®å½•<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="font-icon icon iconfont icon-iconfont icon-java1" style=""></span><span class="title">Java</span><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="font-icon icon iconfont icon-iconfont icon-mn_kuangjia_fill" style=""></span><span class="title">å¸¸ç”¨æ¡†æ¶</span><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="font-icon icon iconfont icon-iconfont icon-shujuku1" style=""></span><span class="title">æ•°æ®åº“</span><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="font-icon icon iconfont icon-iconfont icon-mianshi" style=""></span><span class="title">å¤ç›˜è®°å½•</span><span class="arrow end"></span></button><!----></section></li></ul><!--[--><!----><!--]--></aside><!--[--><main class="page" id="main-content"><!--[--><!----><nav class="breadcrumb disable"></nav><div class="page-title"><h1><span class="font-icon icon iconfont icon-leaf" style=""></span>SpringCloud</h1><div class="page-info"><span class="page-author-info" aria-label="ä½œè€…ğŸ–Š" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="page-author-item" href="https://xcy.icu" target="_blank" rel="noopener noreferrer">CY</a></span><span property="author" content="CY"></span></span><!----><span class="page-date-info" aria-label="å†™ä½œæ—¥æœŸğŸ“…" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span><!----></span><meta property="datePublished" content="2023-07-20T00:00:00.000Z"></span><!----><span class="page-reading-time-info" aria-label="é˜…è¯»æ—¶é—´âŒ›" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>å¤§çº¦ 33 åˆ†é’Ÿ</span><meta property="timeRequired" content="PT33M"></span><span class="page-category-info" aria-label="åˆ†ç±»ğŸŒˆ" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon category-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="category icon"><path d="M148.41 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H148.41c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.311-40.31zM147.556 553.478H429.73c22.263 0 40.311 18.048 40.311 40.31v282.176c0 22.263-18.048 40.312-40.31 40.312H147.555c-22.263 0-40.311-18.049-40.311-40.312V593.79c0-22.263 18.048-40.311 40.31-40.311zM593.927 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H593.927c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.31-40.31zM730.22 920.502H623.926c-40.925 0-74.22-33.388-74.22-74.425V623.992c0-41.038 33.387-74.424 74.425-74.424h222.085c41.038 0 74.424 33.226 74.424 74.067v114.233c0 10.244-8.304 18.548-18.547 18.548s-18.548-8.304-18.548-18.548V623.635c0-20.388-16.746-36.974-37.33-36.974H624.13c-20.585 0-37.331 16.747-37.331 37.33v222.086c0 20.585 16.654 37.331 37.126 37.331H730.22c10.243 0 18.547 8.304 18.547 18.547 0 10.244-8.304 18.547-18.547 18.547z"></path></svg><span class="page-category-item category8 clickable" role="navigation">Spring Cloud</span><meta property="articleSection" content="Spring Cloud"></span><!----></div><hr></div><div class="toc-place-holder"><aside id="toc"><!--[--><!----><!--]--><div class="toc-header">æ­¤é¡µå†…å®¹<button class="print-button" title="æ‰“å°"><svg xmlns="http://www.w3.org/2000/svg" class="icon print-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="print icon"><path d="M819.2 364.8h-44.8V128c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v236.8h-44.8C145.067 364.8 96 413.867 96 473.6v192c0 59.733 49.067 108.8 108.8 108.8h44.8V896c0 17.067 14.933 32 32 32h460.8c17.067 0 32-14.933 32-32V774.4h44.8c59.733 0 108.8-49.067 108.8-108.8v-192c0-59.733-49.067-108.8-108.8-108.8zM313.6 160h396.8v204.8H313.6V160zm396.8 704H313.6V620.8h396.8V864zM864 665.6c0 25.6-19.2 44.8-44.8 44.8h-44.8V588.8c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v121.6h-44.8c-25.6 0-44.8-19.2-44.8-44.8v-192c0-25.6 19.2-44.8 44.8-44.8h614.4c25.6 0 44.8 19.2 44.8 44.8v192z"></path></svg></button></div><div class="toc-wrapper"><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/md/spring/SpringCloud.html#springcloud" class="router-link-active router-link-exact-active toc-link level1">SpringCloud</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/md/spring/SpringCloud.html#ä¸€ã€æœåŠ¡æ³¨å†Œä¸­å¿ƒ" class="router-link-active router-link-exact-active toc-link level2">ä¸€ã€æœåŠ¡æ³¨å†Œä¸­å¿ƒ</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/md/spring/SpringCloud.html#_1ã€eurekaæœåŠ¡æ³¨å†Œä¸å‘ç°" class="router-link-active router-link-exact-active toc-link level3">1ã€EurekaæœåŠ¡æ³¨å†Œä¸å‘ç°</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/md/spring/SpringCloud.html#_2ã€å•æœºæ„å»ºeureka" class="router-link-active router-link-exact-active toc-link level3">2ã€å•æœºæ„å»ºEureka</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/md/spring/SpringCloud.html#_3ã€eurekaé›†ç¾¤åŸç†" class="router-link-active router-link-exact-active toc-link level3">3ã€Eurekaé›†ç¾¤åŸç†</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/md/spring/SpringCloud.html#_4ã€eurekaé›†ç¾¤ç¯å¢ƒæ„å»º" class="router-link-active router-link-exact-active toc-link level3">4ã€Eurekaé›†ç¾¤ç¯å¢ƒæ„å»º</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/md/spring/SpringCloud.html#_5ã€æœåŠ¡å‘ç°discovery" class="router-link-active router-link-exact-active toc-link level3">5ã€æœåŠ¡å‘ç°Discovery</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/md/spring/SpringCloud.html#_5ã€eurekaè‡ªæˆ‘ä¿æŠ¤æœºåˆ¶" class="router-link-active router-link-exact-active toc-link level3">5ã€Eurekaè‡ªæˆ‘ä¿æŠ¤æœºåˆ¶</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/md/spring/SpringCloud.html#äºŒã€zookeeperæœåŠ¡æ³¨å†Œä¸å‘ç°" class="router-link-active router-link-exact-active toc-link level2">äºŒã€ZookeeperæœåŠ¡æ³¨å†Œä¸å‘ç°</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/md/spring/SpringCloud.html#_1ã€æ³¨å†Œä¸­å¿ƒzookeeper" class="router-link-active router-link-exact-active toc-link level3">1ã€æ³¨å†Œä¸­å¿ƒZookeeper</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/md/spring/SpringCloud.html#_2ã€æœåŠ¡æä¾›è€…" class="router-link-active router-link-exact-active toc-link level3">2ã€æœåŠ¡æä¾›è€…</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/md/spring/SpringCloud.html#_3ã€æœåŠ¡æ¶ˆè´¹è€…" class="router-link-active router-link-exact-active toc-link level3">3ã€æœåŠ¡æ¶ˆè´¹è€…</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/md/spring/SpringCloud.html#ä¸‰ã€consulæœåŠ¡æ³¨å†Œä¸å‘ç°" class="router-link-active router-link-exact-active toc-link level2">ä¸‰ã€ConsulæœåŠ¡æ³¨å†Œä¸å‘ç°</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/md/spring/SpringCloud.html#å››ã€ribbonè´Ÿè½½å‡è¡¡æœåŠ¡è°ƒç”¨" class="router-link-active router-link-exact-active toc-link level2">å››ã€Ribbonè´Ÿè½½å‡è¡¡æœåŠ¡è°ƒç”¨</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/md/spring/SpringCloud.html#äº”ã€openfeignæœåŠ¡æ¥å£è°ƒç”¨" class="router-link-active router-link-exact-active toc-link level2">äº”ã€OpenFeignæœåŠ¡æ¥å£è°ƒç”¨</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/md/spring/SpringCloud.html#å…­ã€hystrixæ–­è·¯å™¨" class="router-link-active router-link-exact-active toc-link level2">å…­ã€Hystrixæ–­è·¯å™¨</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/md/spring/SpringCloud.html#ä¸ƒã€zuulè·¯ç”±ç½‘å…³" class="router-link-active router-link-exact-active toc-link level2">ä¸ƒã€zuulè·¯ç”±ç½‘å…³</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/md/spring/SpringCloud.html#å…«ã€gatewayç½‘å…³" class="router-link-active router-link-exact-active toc-link level2">å…«ã€GateWayç½‘å…³</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/md/spring/SpringCloud.html#_1ã€æ¦‚è¿°" class="router-link-active router-link-exact-active toc-link level3">1ã€æ¦‚è¿°</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/md/spring/SpringCloud.html#_2ã€ä¸‰å¤§æ ¸å¿ƒæ¦‚å¿µ" class="router-link-active router-link-exact-active toc-link level3">2ã€ä¸‰å¤§æ ¸å¿ƒæ¦‚å¿µ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/md/spring/SpringCloud.html#_3ã€gatewayå·¥ä½œæµç¨‹" class="router-link-active router-link-exact-active toc-link level3">3ã€GateWayå·¥ä½œæµç¨‹</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/md/spring/SpringCloud.html#_4ã€å…¥é—¨é…ç½®" class="router-link-active router-link-exact-active toc-link level3">4ã€å…¥é—¨é…ç½®</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/md/spring/SpringCloud.html#_5ã€é€šè¿‡å¾®æœåŠ¡åå®ç°åŠ¨æ€è·¯ç”±" class="router-link-active router-link-exact-active toc-link level3">5ã€é€šè¿‡å¾®æœåŠ¡åå®ç°åŠ¨æ€è·¯ç”±</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/md/spring/SpringCloud.html#_6ã€predicateçš„ä½¿ç”¨" class="router-link-active router-link-exact-active toc-link level3">6ã€Predicateçš„ä½¿ç”¨</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/md/spring/SpringCloud.html#_7ã€filterçš„ä½¿ç”¨" class="router-link-active router-link-exact-active toc-link level3">7ã€Filterçš„ä½¿ç”¨</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/md/spring/SpringCloud.html#ä¹ã€springcloud-configåˆ†å¸ƒå¼é…ç½®ä¸­å¿ƒ" class="router-link-active router-link-exact-active toc-link level2">ä¹ã€SpringCloud Configåˆ†å¸ƒå¼é…ç½®ä¸­å¿ƒ</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/md/spring/SpringCloud.html#_1ã€æ¦‚è¿°-1" class="router-link-active router-link-exact-active toc-link level3">1ã€æ¦‚è¿°</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/md/spring/SpringCloud.html#_2ã€configæœåŠ¡ç«¯é…ç½®" class="router-link-active router-link-exact-active toc-link level3">2ã€ConfigæœåŠ¡ç«¯é…ç½®</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/md/spring/SpringCloud.html#_3ã€configå®¢æˆ·ç«¯é…ç½®" class="router-link-active router-link-exact-active toc-link level3">3ã€Configå®¢æˆ·ç«¯é…ç½®</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/md/spring/SpringCloud.html#_4ã€configå®¢æˆ·ç«¯åŠ¨æ€åˆ·æ–°" class="router-link-active router-link-exact-active toc-link level3">4ã€Configå®¢æˆ·ç«¯åŠ¨æ€åˆ·æ–°</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/md/spring/SpringCloud.html#åã€springcloud-busæ¶ˆæ¯æ€»çº¿" class="router-link-active router-link-exact-active toc-link level2">åã€SpringCloud Busæ¶ˆæ¯æ€»çº¿</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/md/spring/SpringCloud.html#_1ã€æ¦‚è¿°-2" class="router-link-active router-link-exact-active toc-link level3">1ã€æ¦‚è¿°</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/md/spring/SpringCloud.html#_2ã€busä¹‹rabbitmqç¯å¢ƒé…ç½®" class="router-link-active router-link-exact-active toc-link level3">2ã€Busä¹‹RabbitMQç¯å¢ƒé…ç½®</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/md/spring/SpringCloud.html#_3ã€springcloud-busåŠ¨æ€åˆ·æ–°å…¨å±€å¹¿æ’­" class="router-link-active router-link-exact-active toc-link level3">3ã€SpringCloud BusåŠ¨æ€åˆ·æ–°å…¨å±€å¹¿æ’­</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/md/spring/SpringCloud.html#_4ã€springcloud-busåŠ¨æ€åˆ·æ–°å®šç‚¹é€šçŸ¥" class="router-link-active router-link-exact-active toc-link level3">4ã€SpringCloud BusåŠ¨æ€åˆ·æ–°å®šç‚¹é€šçŸ¥</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/md/spring/SpringCloud.html#åä¸€ã€springcloud-streamæ¶ˆæ¯é©±åŠ¨" class="router-link-active router-link-exact-active toc-link level2">åä¸€ã€SpringCloud Streamæ¶ˆæ¯é©±åŠ¨</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/md/spring/SpringCloud.html#_1ã€æ¦‚è¿°-3" class="router-link-active router-link-exact-active toc-link level3">1ã€æ¦‚è¿°</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/md/spring/SpringCloud.html#åäºŒã€springcloud-sleuthåˆ†å¸ƒå¼è¯·æ±‚é“¾è·¯è·Ÿè¸ª" class="router-link-active router-link-exact-active toc-link level2">åäºŒã€SpringCloud Sleuthåˆ†å¸ƒå¼è¯·æ±‚é“¾è·¯è·Ÿè¸ª</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/md/spring/SpringCloud.html#_1ã€æ¦‚è¿°-4" class="router-link-active router-link-exact-active toc-link level3">1ã€æ¦‚è¿°</a></li><!----><!--]--></ul><!--]--></ul><!--]--></ul></div><!--[--><!----><!--]--></aside></div><!----><div class="theme-hope-content"><p><code>more</code> æœ¬æ–‡ç« ä¸»è¦ä»‹ç»Springæ¡†æ¶æ•´ä½“æ¶æ„ï¼ŒSpringçš„æ ¸å¿ƒIOCï¼ŒAOPçš„æ¡ˆä¾‹å’Œå…·ä½“å®ç°æœºåˆ¶ï¼›ä»¥åŠSpringMVCæ¡†æ¶çš„æ¡ˆä¾‹å’Œå®ç°æœºåˆ¶ã€‚</p><!-- more --><h1 id="springcloud" tabindex="-1"><a class="header-anchor" href="#springcloud" aria-hidden="true">#</a> SpringCloud</h1><h2 id="ä¸€ã€æœåŠ¡æ³¨å†Œä¸­å¿ƒ" tabindex="-1"><a class="header-anchor" href="#ä¸€ã€æœåŠ¡æ³¨å†Œä¸­å¿ƒ" aria-hidden="true">#</a> ä¸€ã€æœåŠ¡æ³¨å†Œä¸­å¿ƒ</h2><h3 id="_1ã€eurekaæœåŠ¡æ³¨å†Œä¸å‘ç°" tabindex="-1"><a class="header-anchor" href="#_1ã€eurekaæœåŠ¡æ³¨å†Œä¸å‘ç°" aria-hidden="true">#</a> 1ã€EurekaæœåŠ¡æ³¨å†Œä¸å‘ç°</h3><p><strong>ä»€ä¹ˆæ˜¯æœåŠ¡æ²»ç†ï¼Ÿ</strong></p><p>Spring Cloud å°è£…äº† Netflix å…¬å¸å¼€å‘çš„ Eureka æ¨¡å—æ¥<strong>å®ç°æœåŠ¡æ²»ç†</strong></p><p>åœ¨ä¼ ç»Ÿçš„rpcè¿œç¨‹è°ƒç”¨æ¡†æ¶ä¸­ï¼Œç®¡ç†æ¯ä¸ªæœåŠ¡ä¸æœåŠ¡ä¹‹é—´ä¾èµ–å…³ç³»æ¯”è¾ƒå¤æ‚ï¼Œç®¡ç†æ¯”è¾ƒå¤æ‚ï¼Œæ‰€ä»¥éœ€è¦ä½¿ç”¨æœåŠ¡æ²»ç†ï¼Œç®¡ç†æœåŠ¡äºæœåŠ¡ä¹‹é—´ä¾èµ–å…³ç³»ï¼Œå¯ä»¥å®ç°æœåŠ¡è°ƒç”¨ã€è´Ÿè½½å‡è¡¡ã€å®¹é”™ç­‰ï¼Œå®ç°æœåŠ¡å‘ç°ä¸æ³¨å†Œã€‚</p><p><strong>ä»€ä¹ˆæ˜¯æœåŠ¡æ³¨å†Œä¸å‘ç°ï¼Ÿ</strong></p><p>Eurekaé‡‡ç”¨äº†CSçš„è®¾è®¡æ¶æ„ï¼ŒEureka Server ä½œä¸ºæœåŠ¡æ³¨å†ŒåŠŸèƒ½çš„æœåŠ¡å™¨ï¼Œå®ƒæ˜¯æœåŠ¡æ³¨å†Œä¸­å¿ƒã€‚è€Œç³»ç»Ÿä¸­çš„å…¶ä»–å¾®æœåŠ¡ï¼Œä½¿ç”¨ Eurekaçš„å®¢æˆ·ç«¯è¿æ¥åˆ° Eureka Serverå¹¶ç»´æŒå¿ƒè·³è¿æ¥ã€‚è¿™æ ·ç³»ç»Ÿçš„ç»´æŠ¤äººå‘˜å°±å¯ä»¥é€šè¿‡ Eureka Server æ¥ç›‘æ§ç³»ç»Ÿä¸­å„ä¸ªå¾®æœåŠ¡æ˜¯å¦æ­£å¸¸è¿è¡Œã€‚</p><p>åœ¨æœåŠ¡æ³¨å†Œä¸å‘ç°ä¸­ï¼Œæœ‰ä¸€ä¸ªæ³¨å†Œä¸­å¿ƒã€‚å½“æœåŠ¡å™¨å¯åŠ¨çš„æ—¶å€™ï¼Œä¼šæŠŠå½“å‰è‡ªå·±æœåŠ¡å™¨çš„ä¿¡æ¯ æ¯”å¦‚ æœåŠ¡åœ°å€é€šè®¯åœ°å€ç­‰ä»¥åˆ«åæ–¹å¼æ³¨å†Œåˆ°æ³¨å†Œä¸­å¿ƒä¸Šã€‚å¦ä¸€æ–¹ï¼ˆæ¶ˆè´¹è€…|æœåŠ¡æä¾›è€…ï¼‰ï¼Œä»¥è¯¥åˆ«åçš„æ–¹å¼å»æ³¨å†Œä¸­å¿ƒä¸Šè·å–åˆ°å®é™…çš„æœåŠ¡é€šè®¯åœ°å€ï¼Œç„¶åå†å®ç°æœ¬åœ°RPCè°ƒç”¨RPCè¿œç¨‹è°ƒç”¨æ¡†æ¶æ ¸å¿ƒè®¾è®¡æ€æƒ³ï¼šåœ¨äºæ³¨å†Œä¸­å¿ƒï¼Œå› ä¸ºä½¿ç”¨æ³¨å†Œä¸­å¿ƒç®¡ç†æ¯ä¸ªæœåŠ¡ä¸æœåŠ¡ä¹‹é—´çš„ä¸€ä¸ªä¾èµ–å…³ç³»(æœåŠ¡æ²»ç†æ¦‚å¿µ)ã€‚åœ¨ä»»ä½•rpcè¿œç¨‹æ¡†æ¶ä¸­ï¼Œéƒ½ä¼šæœ‰ä¸€ä¸ªæ³¨å†Œä¸­å¿ƒ(å­˜æ”¾æœåŠ¡åœ°å€ç›¸å…³ä¿¡æ¯(æ¥å£åœ°å€))</p><p>ä¸‹å·¦å›¾æ˜¯Eurekaç³»ç»Ÿæ¶æ„ï¼Œå³å›¾æ˜¯Dubboçš„æ¶æ„ï¼Œè¯·å¯¹æ¯”</p><figure><img src="https://xcy-fcblog-1304336794.cos.ap-nanjing.myqcloud.com/posts/SpringCloud/image-20230422122541585.png" alt="image-20230422122541585" tabindex="0" loading="lazy"><figcaption>image-20230422122541585</figcaption></figure><p><strong>Eurekaçš„ä¸¤ä¸ªç»„ä»¶</strong></p><p><strong>Eureka Serveræä¾›æœåŠ¡æ³¨å†ŒæœåŠ¡</strong></p><p>å„ä¸ªå¾®æœåŠ¡èŠ‚ç‚¹é€šè¿‡é…ç½®å¯åŠ¨åï¼Œä¼šåœ¨EurekaServerä¸­è¿›è¡Œæ³¨å†Œï¼Œè¿™æ ·EurekaServerä¸­çš„æœåŠ¡æ³¨å†Œè¡¨ä¸­å°†ä¼šå­˜å‚¨æ‰€æœ‰å¯ç”¨æœåŠ¡èŠ‚ç‚¹çš„ä¿¡æ¯ï¼ŒæœåŠ¡èŠ‚ç‚¹çš„ä¿¡æ¯å¯ä»¥åœ¨ç•Œé¢ä¸­ç›´è§‚çœ‹åˆ°ã€‚</p><p><strong>EurekaClienté€šè¿‡æ³¨å†Œä¸­å¿ƒè¿›è¡Œè®¿é—®</strong></p><p>æ˜¯ä¸€ä¸ªJavaå®¢æˆ·ç«¯ï¼Œç”¨äºç®€åŒ–Eureka Serverçš„äº¤äº’ï¼Œå®¢æˆ·ç«¯åŒæ—¶ä¹Ÿå…·å¤‡ä¸€ä¸ªå†…ç½®çš„ã€ä½¿ç”¨è½®è¯¢(round-robin)è´Ÿè½½ç®—æ³•çš„è´Ÿè½½å‡è¡¡å™¨ã€‚åœ¨åº”ç”¨å¯åŠ¨åï¼Œå°†ä¼šå‘Eureka Serverå‘é€å¿ƒè·³(é»˜è®¤å‘¨æœŸä¸º30ç§’)ã€‚å¦‚æœEureka Serveråœ¨å¤šä¸ªå¿ƒè·³å‘¨æœŸå†…æ²¡æœ‰æ¥æ”¶åˆ°æŸä¸ªèŠ‚ç‚¹çš„å¿ƒè·³ï¼ŒEurekaServerå°†ä¼šä»æœåŠ¡æ³¨å†Œè¡¨ä¸­æŠŠè¿™ä¸ªæœåŠ¡èŠ‚ç‚¹ç§»é™¤ï¼ˆé»˜è®¤90ç§’ï¼‰</p><h3 id="_2ã€å•æœºæ„å»ºeureka" tabindex="-1"><a class="header-anchor" href="#_2ã€å•æœºæ„å»ºeureka" aria-hidden="true">#</a> 2ã€å•æœºæ„å»ºEureka</h3><ul><li><p>æ„å»ºmoduleï¼šcloud-eureka-server7001</p></li><li><p>è¯¥pomæ–‡ä»¶ï¼š</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token prolog">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>project</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://maven.apache.org/POM/4.0.0<span class="token punctuation">&quot;</span></span>
         <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">&quot;</span></span>
         <span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>parent</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>mscloud03<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.atguigu.springcloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.0-SNAPSHOT<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>parent</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>modelVersion</span><span class="token punctuation">&gt;</span></span>4.0.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>modelVersion</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>cloud-eureka-server7001<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!--eureka-server--&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-cloud-starter-netflix-eureka-server<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!-- å¼•å…¥è‡ªå·±å®šä¹‰çš„apié€šç”¨åŒ…ï¼Œå¯ä»¥ä½¿ç”¨Paymentæ”¯ä»˜Entity --&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.atguigu.springcloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>cloud-api-commons<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>${project.version}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!--boot web actuator--&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-web<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-actuator<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!--ä¸€èˆ¬é€šç”¨é…ç½®--&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-devtools<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scope</span><span class="token punctuation">&gt;</span></span>runtime<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scope</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>optional</span><span class="token punctuation">&gt;</span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>optional</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.projectlombok<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>lombok<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-test<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scope</span><span class="token punctuation">&gt;</span></span>test<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scope</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>junit<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>junit<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>project</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>å†™ymlæ–‡ä»¶</p><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">server</span><span class="token punctuation">:</span>
  <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">7001</span>

<span class="token key atrule">eureka</span><span class="token punctuation">:</span>
  <span class="token key atrule">instance</span><span class="token punctuation">:</span>
    <span class="token key atrule">hostname</span><span class="token punctuation">:</span> localhost <span class="token comment">#eurekaæœåŠ¡ç«¯çš„å®ä¾‹åç§°</span>
  <span class="token key atrule">client</span><span class="token punctuation">:</span>
    <span class="token comment">#falseè¡¨ç¤ºä¸å‘æ³¨å†Œä¸­å¿ƒæ³¨å†Œè‡ªå·±ã€‚</span>
    <span class="token key atrule">register-with-eureka</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>
    <span class="token comment">#falseè¡¨ç¤ºè‡ªå·±ç«¯å°±æ˜¯æ³¨å†Œä¸­å¿ƒï¼Œæˆ‘çš„èŒè´£å°±æ˜¯ç»´æŠ¤æœåŠ¡å®ä¾‹ï¼Œå¹¶ä¸éœ€è¦å»æ£€ç´¢æœåŠ¡</span>
    <span class="token key atrule">fetch-registry</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>
    <span class="token key atrule">service-url</span><span class="token punctuation">:</span>
    <span class="token comment">#è®¾ç½®ä¸Eureka Serveräº¤äº’çš„åœ°å€æŸ¥è¯¢æœåŠ¡å’Œæ³¨å†ŒæœåŠ¡éƒ½éœ€è¦ä¾èµ–è¿™ä¸ªåœ°å€ã€‚</span>
      <span class="token key atrule">defaultZone</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//$<span class="token punctuation">{</span>eureka.instance.hostname<span class="token punctuation">}</span><span class="token punctuation">:</span>$<span class="token punctuation">{</span>server.port<span class="token punctuation">}</span>/eureka/
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>ä¸»å¯åŠ¨</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@SpringBootApplication</span>
<span class="token annotation punctuation">@EnableEurekaServer</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">EurekaMain7001</span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token class-name">SpringApplication</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">EurekaMain7001</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>å¯åŠ¨é¡¹ç›®ï¼Œè¿›å…¥<a href="http://localhost:7001/%E7%AB%AF%E5%8F%A3%EF%BC%8C%E6%9F%A5%E7%9C%8B%E7%BB%93%E6%9E%9C" target="_blank" rel="noopener noreferrer">http://localhost:7001/ç«¯å£ï¼ŒæŸ¥çœ‹ç»“æœ<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p></li></ul><figure><img src="https://xcy-fcblog-1304336794.cos.ap-nanjing.myqcloud.com/posts/SpringCloud/image-20230422140900157.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>å¦‚æœå‡ºç°ä»¥ä¸Šçš„spring Eurekaé¡µé¢ï¼Œè¡¨ç¤ºæˆåŠŸï¼Œä½†æ˜¯å› ä¸ºè¿˜æ²¡æœ‰æœåŠ¡æ³¨å†Œè¿›æ¥ï¼Œæ‰€ä»¥æ²¡æœ‰æœåŠ¡è¢«å‘ç°</p><p>æ¥ä¸‹æ¥åˆ›å»ºcloud-provider-payment8001æ¨¡å—</p><p>åœ¨å…¶pomæ–‡ä»¶ä¸­æ·»åŠ ï¼š</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token comment">&lt;!--eureka-client--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-cloud-starter-netflix-eureka-client<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¹‹åå†ymlæ–‡ä»¶ä¸­è¿›è¡Œé…ç½®ï¼Œå°†cloud-provider-payment8001æ³¨å†Œåˆ°eurekaæœåŠ¡ä¸­</p><div class="language-properties line-numbers-mode" data-ext="properties"><pre class="language-properties"><code><span class="token key attr-name">eureka</span><span class="token punctuation">:</span>
<span class="token key attr-name">  client</span><span class="token punctuation">:</span>
<span class="token comment">    #è¡¨ç¤ºæ˜¯å¦å°†è‡ªå·±æ³¨å†Œè¿›EurekaServeré»˜è®¤ä¸ºtrueã€‚</span>
<span class="token key attr-name">    register-with-eureka</span><span class="token punctuation">:</span> <span class="token value attr-value">true</span>
<span class="token comment">    #æ˜¯å¦ä»EurekaServeræŠ“å–å·²æœ‰çš„æ³¨å†Œä¿¡æ¯ï¼Œé»˜è®¤ä¸ºtrueã€‚å•èŠ‚ç‚¹æ— æ‰€è°“ï¼Œé›†ç¾¤å¿…é¡»è®¾ç½®ä¸ºtrueæ‰èƒ½é…åˆribbonä½¿ç”¨è´Ÿè½½å‡è¡¡</span>
<span class="token key attr-name">    fetchRegistry</span><span class="token punctuation">:</span> <span class="token value attr-value">true</span>
<span class="token key attr-name">    service-url</span><span class="token punctuation">:</span>
<span class="token key attr-name">      defaultZone</span><span class="token punctuation">:</span> <span class="token value attr-value">http://localhost:7001/eureka</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://xcy-fcblog-1304336794.cos.ap-nanjing.myqcloud.com/posts/SpringCloud/image-20230422151135002.png" alt="image-20230422151135002" tabindex="0" loading="lazy"><figcaption>image-20230422151135002</figcaption></figure><p>æ³¨å†Œåè¿›è¡Œå¯åŠ¨ï¼Œåœ¨ä¸Šå›¾ä¸­çœ‹åˆ°applicationä¸­æœ‰äº†ä¸€ä¸ªcloud-payment-serviceå°±è¡¨ç¤ºæ³¨å†ŒæˆåŠŸ</p><h3 id="_3ã€eurekaé›†ç¾¤åŸç†" tabindex="-1"><a class="header-anchor" href="#_3ã€eurekaé›†ç¾¤åŸç†" aria-hidden="true">#</a> 3ã€Eurekaé›†ç¾¤åŸç†</h3><figure><img src="https://xcy-fcblog-1304336794.cos.ap-nanjing.myqcloud.com/posts/SpringCloud/image-20230422154457389.png" alt="image-20230422154457389" tabindex="0" loading="lazy"><figcaption>image-20230422154457389</figcaption></figure><p><strong>å¾®æœåŠ¡RPCè¿œç¨‹æœåŠ¡è°ƒç”¨æœ€æ ¸å¿ƒ</strong>çš„æ˜¯<mark>é«˜å¯ç”¨</mark>ï¼Œå¦‚æœæ³¨å†Œä¸­å¿ƒï¼Œåªæœ‰ä¸€ä¸ªï¼Œä½†æ˜¯å®ƒä¸€æ—¦å‡ºæ•…éšœï¼Œä¼šå¯¼è‡´æ•´ä¸ªæœåŠ¡ç¯å¢ƒä¸å¯ç”¨</p><p>è§£å†³åŠæ³•ï¼šæ­å»ºEurekaæ³¨å†Œä¸­å¿ƒé›†ç¾¤ï¼Œå®ç°<mark>è´Ÿè½½å‡è¡¡+æ•…éšœå®¹é”™</mark></p><h3 id="_4ã€eurekaé›†ç¾¤ç¯å¢ƒæ„å»º" tabindex="-1"><a class="header-anchor" href="#_4ã€eurekaé›†ç¾¤ç¯å¢ƒæ„å»º" aria-hidden="true">#</a> 4ã€Eurekaé›†ç¾¤ç¯å¢ƒæ„å»º</h3><ul><li><p>æ–°å»ºæ¨¡å—cloud-eureka-server7002</p></li><li><p>å‚è€ƒcloud-eureka-server7001é‡æ–°æ”¹pomæ–‡ä»¶</p></li><li><p>ä¿®æ”¹æ˜ å°„é…ç½®</p><ul><li><p>ä¿®æ”¹æ‰¾åˆ°C:\Windows\System32\drivers\etc\hostsæ–‡ä»¶ï¼Œåœ¨å…¶ä¸­æ·»åŠ </p><blockquote><p>127.0.0.1 <a href="http://eureka7001.com" target="_blank" rel="noopener noreferrer">eureka7001.com<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p>127.0.0.1 <a href="http://eureka7002.com" target="_blank" rel="noopener noreferrer">eureka7002.com<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p></blockquote></li></ul></li><li><p>åœ¨ymlé…ç½®æ–‡ä»¶ä¸­ä¿®æ”¹é…ç½®</p><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">eureka</span><span class="token punctuation">:</span>
  <span class="token key atrule">instance</span><span class="token punctuation">:</span>
    <span class="token key atrule">hostname</span><span class="token punctuation">:</span> eureka7001.com <span class="token comment">#eurekaæœåŠ¡ç«¯çš„å®ä¾‹åç§°</span>
  <span class="token key atrule">client</span><span class="token punctuation">:</span>
    <span class="token comment">#falseè¡¨ç¤ºä¸å‘æ³¨å†Œä¸­å¿ƒæ³¨å†Œè‡ªå·±ã€‚</span>
    <span class="token key atrule">register-with-eureka</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>
    <span class="token comment">#falseè¡¨ç¤ºè‡ªå·±ç«¯å°±æ˜¯æ³¨å†Œä¸­å¿ƒï¼Œæˆ‘çš„èŒè´£å°±æ˜¯ç»´æŠ¤æœåŠ¡å®ä¾‹ï¼Œå¹¶ä¸éœ€è¦å»æ£€ç´¢æœåŠ¡</span>
    <span class="token key atrule">fetch-registry</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>
    <span class="token key atrule">service-url</span><span class="token punctuation">:</span>
      <span class="token comment">#è®¾ç½®ä¸Eureka Serveräº¤äº’çš„åœ°å€æŸ¥è¯¢æœåŠ¡å’Œæ³¨å†ŒæœåŠ¡éƒ½éœ€è¦ä¾èµ–è¿™ä¸ªåœ°å€ã€‚</span>
      <span class="token key atrule">defaultZone</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//eureka7002.com<span class="token punctuation">:</span>7002/eureka/
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å…¶ä¸­defaultZoneä¸­çš„<a href="http://eureka7002.com:7002/eureka/%E8%A1%A8%E7%A4%BAcloud-eureka-server7001%E5%AE%88%E6%9C%9Bcloud-eureka-server7002%EF%BC%8C%E5%9C%A87cloud-eureka-server7002%E4%B8%AD%E5%BA%94%E8%AF%A5%E5%B0%86%E5%85%B6%E6%94%B9%E4%B8%BAhttp://eureka7001.com:7001/eureka/%EF%BC%8C%E8%A1%A8%E7%A4%BA7002%E5%AE%88%E6%9C%9Bcloud-eureka-server7001" target="_blank" rel="noopener noreferrer">http://eureka7002.com:7002/eureka/è¡¨ç¤ºcloud-eureka-server7001å®ˆæœ›cloud-eureka-server7002ï¼Œåœ¨7cloud-eureka-server7002ä¸­åº”è¯¥å°†å…¶æ”¹ä¸ºhttp://eureka7001.com:7001/eureka/ï¼Œè¡¨ç¤º7002å®ˆæœ›cloud-eureka-server7001<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p></li><li><p>ä¿®æ”¹cloud-provider-payment8001æ¨¡å—ymlé…ç½®æ–‡ä»¶ä¸­çš„eurekaé…ç½®ä¿®æ”¹ä¸ºï¼š</p><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">eureka</span><span class="token punctuation">:</span>
  <span class="token key atrule">client</span><span class="token punctuation">:</span>
    <span class="token comment">#falseè¡¨ç¤ºä¸å‘æ³¨å†Œä¸­å¿ƒæ³¨å†Œè‡ªå·±ã€‚</span>
    <span class="token key atrule">register-with-eureka</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
    <span class="token comment">#falseè¡¨ç¤ºè‡ªå·±ç«¯å°±æ˜¯æ³¨å†Œä¸­å¿ƒï¼Œæˆ‘çš„èŒè´£å°±æ˜¯ç»´æŠ¤æœåŠ¡å®ä¾‹ï¼Œå¹¶ä¸éœ€è¦å»æ£€ç´¢æœåŠ¡</span>
    <span class="token key atrule">fetch-registry</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
    <span class="token key atrule">service-url</span><span class="token punctuation">:</span>
      <span class="token comment">#è®¾ç½®ä¸Eureka Serveräº¤äº’çš„åœ°å€æŸ¥è¯¢æœåŠ¡å’Œæ³¨å†ŒæœåŠ¡éƒ½éœ€è¦ä¾èµ–è¿™ä¸ªåœ°å€ã€‚</span>
      <span class="token comment">#defaultZone: http://localhost:7001/eureka                                          # å•æœºç‰ˆ</span>
      <span class="token key atrule">defaultZone</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//eureka7001.com<span class="token punctuation">:</span>7001/eureka/<span class="token punctuation">,</span>http<span class="token punctuation">:</span>//eureka7002.com<span class="token punctuation">:</span>7002/eureka/  <span class="token comment"># é›†ç¾¤ç‰ˆ</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>å¯åŠ¨æ‰€æœ‰æ‰€æœ‰æ¨¡å—ï¼ŒæŸ¥çœ‹ç»“æœ</p><figure><img src="https://xcy-fcblog-1304336794.cos.ap-nanjing.myqcloud.com/posts/SpringCloud/image-20230422162914858.png" alt="image-20230422162914858" tabindex="0" loading="lazy"><figcaption>image-20230422162914858</figcaption></figure></li><li><p>åˆ›å»ºcloud-provider-payment8002æ¨¡å—ï¼Œä½¿å…¶ä¿æŒå’Œcloud-provider-payment8001ä¿æŒä¸€è‡´</p><ul><li><p>ä¿®æ”¹cloud-consumer-order80ä¸­çš„Controller</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Slf4j</span>
<span class="token annotation punctuation">@RestController</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">OrderController</span> <span class="token punctuation">{</span>

    <span class="token comment">//public static final String PAYMENT_URL = &quot;http://localhost:8001&quot;;</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token constant">PAYMENT_URL</span> <span class="token operator">=</span> <span class="token string">&quot;http://CLOUD-PAYMENT-SERVICE&quot;</span><span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Resource</span>
    <span class="token keyword">private</span> <span class="token class-name">RestTemplate</span> restTemplate<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/consumer/payment/create&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">CommonResult</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Payment</span><span class="token punctuation">&gt;</span></span> <span class="token function">create</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestBody</span> <span class="token class-name">Payment</span> payment<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> restTemplate<span class="token punctuation">.</span><span class="token function">postForObject</span><span class="token punctuation">(</span><span class="token constant">PAYMENT_URL</span> <span class="token operator">+</span> <span class="token string">&quot;/payment/create&quot;</span><span class="token punctuation">,</span> payment<span class="token punctuation">,</span> <span class="token class-name">CommonResult</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/consumer/payment/getPayment/{id}&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">CommonResult</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Payment</span><span class="token punctuation">&gt;</span></span> <span class="token function">getPayment</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span> <span class="token class-name">Long</span> id<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> restTemplate<span class="token punctuation">.</span><span class="token function">getForObject</span><span class="token punctuation">(</span><span class="token constant">PAYMENT_URL</span> <span class="token operator">+</span> <span class="token string">&quot;/payment/getPaymentById/&quot;</span> <span class="token operator">+</span> id<span class="token punctuation">,</span> <span class="token class-name">CommonResult</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>åœ¨ApplicationContextConfigä¸­æ·»åŠ æ³¨è§£@LoadBalancedå¼€å¯è´Ÿè½½å‡è¡¡ï¼Œè½®è®­å„ä¸ªæœåŠ¡</p></li><li><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ApplicationContextConfig</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token annotation punctuation">@LoadBalanced</span>
    <span class="token keyword">public</span> <span class="token class-name">RestTemplate</span> <span class="token function">getRestTemplate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">RestTemplate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul></li></ul><h3 id="_5ã€æœåŠ¡å‘ç°discovery" tabindex="-1"><a class="header-anchor" href="#_5ã€æœåŠ¡å‘ç°discovery" aria-hidden="true">#</a> 5ã€æœåŠ¡å‘ç°Discovery</h3><p>å¯¹äºæ³¨å†Œè¿›eurekaé‡Œé¢çš„å¾®æœåŠ¡ï¼Œå¯ä»¥é€šè¿‡å¾®æœåŠ¡å‘ç°æ¥è·å¾—è¯¥æœåŠ¡çš„ä¿¡æ¯</p><p>ä¿®æ”¹cloud-provider-payment8001çš„Controller</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Resource</span>
<span class="token keyword">private</span> <span class="token class-name">DiscoveryClient</span> discoveryClient<span class="token punctuation">;</span>
<span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;/payment/discovery&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">discovery</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> services <span class="token operator">=</span> discoveryClient<span class="token punctuation">.</span><span class="token function">getServices</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">String</span> element <span class="token operator">:</span> services<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>element<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ServiceInstance</span><span class="token punctuation">&gt;</span></span> instances <span class="token operator">=</span> discoveryClient<span class="token punctuation">.</span><span class="token function">getInstances</span><span class="token punctuation">(</span><span class="token string">&quot;CLOUD-PAYMENT-SERVICE&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">ServiceInstance</span> element <span class="token operator">:</span> instances<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>element<span class="token punctuation">.</span><span class="token function">getServiceId</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;\t&quot;</span> <span class="token operator">+</span> element<span class="token punctuation">.</span><span class="token function">getHost</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;\t&quot;</span> <span class="token operator">+</span> element<span class="token punctuation">.</span><span class="token function">getPort</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;\t&quot;</span>
                <span class="token operator">+</span> element<span class="token punctuation">.</span><span class="token function">getUri</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>discoveryClient<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¿®æ”¹ä¸»å¯åŠ¨ç±»</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@SpringBootApplication</span>
<span class="token annotation punctuation">@EnableEurekaClient</span>
<span class="token annotation punctuation">@EnableDiscoveryClient</span> <span class="token comment">//æœåŠ¡å‘ç°</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PaymentMain8001</span><span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token class-name">SpringApplication</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">PaymentMain8001</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_5ã€eurekaè‡ªæˆ‘ä¿æŠ¤æœºåˆ¶" tabindex="-1"><a class="header-anchor" href="#_5ã€eurekaè‡ªæˆ‘ä¿æŠ¤æœºåˆ¶" aria-hidden="true">#</a> 5ã€Eurekaè‡ªæˆ‘ä¿æŠ¤æœºåˆ¶</h3><h4 id="æ¦‚è¿°" tabindex="-1"><a class="header-anchor" href="#æ¦‚è¿°" aria-hidden="true">#</a> æ¦‚è¿°</h4><p>ä¿æŠ¤æ¨¡å¼ä¸»è¦ç”¨äºä¸€ç»„å®¢æˆ·ç«¯å’ŒEureka Serverä¹‹é—´å­˜åœ¨ç½‘ç»œåˆ†åŒºåœºæ™¯ä¸‹çš„ä¿æŠ¤ã€‚ä¸€æ—¦è¿›å…¥ä¿æŠ¤æ¨¡å¼ï¼Œ Eureka Serverå°†ä¼šå°è¯•ä¿æŠ¤å…¶æœåŠ¡æ³¨å†Œè¡¨ä¸­çš„ä¿¡æ¯ï¼Œä¸å†åˆ é™¤æœåŠ¡æ³¨å†Œè¡¨ä¸­çš„æ•°æ®ï¼Œä¹Ÿå°±æ˜¯ä¸ä¼šæ³¨é”€ä»»ä½•å¾®æœåŠ¡ã€‚</p><p>å¦‚æœåœ¨Eureka Serverçš„é¦–é¡µçœ‹åˆ°ä»¥ä¸‹è¿™æ®µæç¤ºï¼Œåˆ™è¯´æ˜Eurekaè¿›å…¥äº†ä¿æŠ¤æ¨¡å¼ï¼š EMERGENCY! EUREKA MAY BE INCORRECTLY CLAIMING INSTANCES ARE UP WHEN THEY&#39;RE NOT. RENEWALS ARE LESSER THAN THRESHOLD AND HENCE THE INSTANCES ARE NOT BEING EXPIRED JUST TO BE SAFE</p><figure><img src="https://xcy-fcblog-1304336794.cos.ap-nanjing.myqcloud.com/posts/SpringCloud/Eurekaçš„è‡ªæˆ‘ä¿æŠ¤æœºåˆ¶.png" alt="Eurekaçš„è‡ªæˆ‘ä¿æŠ¤æœºåˆ¶" tabindex="0" loading="lazy"><figcaption>Eurekaçš„è‡ªæˆ‘ä¿æŠ¤æœºåˆ¶</figcaption></figure><p><strong>ä¸ºä»€ä¹ˆä¼šäº§ç”ŸEurekaè‡ªæˆ‘ä¿æŠ¤æœºåˆ¶ï¼Ÿ</strong> ä¸ºäº†é˜²æ­¢EurekaClientå¯ä»¥æ­£å¸¸è¿è¡Œï¼Œä½†æ˜¯ ä¸ EurekaServerç½‘ç»œä¸é€šæƒ…å†µä¸‹ï¼ŒEurekaServerä¸ä¼šç«‹åˆ»å°†EurekaClientæœåŠ¡å‰”é™¤</p><p><strong>ä»€ä¹ˆæ˜¯è‡ªæˆ‘ä¿æŠ¤æ¨¡å¼ï¼Ÿ</strong> é»˜è®¤æƒ…å†µä¸‹ï¼Œå¦‚æœEurekaServeråœ¨ä¸€å®šæ—¶é—´å†…æ²¡æœ‰æ¥æ”¶åˆ°æŸä¸ªå¾®æœåŠ¡å®ä¾‹çš„å¿ƒè·³ï¼ŒEurekaServerå°†ä¼šæ³¨é”€è¯¥å®ä¾‹ï¼ˆé»˜è®¤90ç§’ï¼‰ã€‚ä½†æ˜¯å½“ç½‘ç»œåˆ†åŒºæ•…éšœå‘ç”Ÿ(å»¶æ—¶ã€å¡é¡¿ã€æ‹¥æŒ¤)æ—¶ï¼Œå¾®æœåŠ¡ä¸EurekaServerä¹‹é—´æ— æ³•æ­£å¸¸é€šä¿¡ï¼Œä»¥ä¸Šè¡Œä¸ºå¯èƒ½å˜å¾—éå¸¸å±é™©äº†â€”â€”å› ä¸ºå¾®æœåŠ¡æœ¬èº«å…¶å®æ˜¯å¥åº·çš„ï¼Œæ­¤æ—¶æœ¬ä¸åº”è¯¥æ³¨é”€è¿™ä¸ªå¾®æœåŠ¡ã€‚Eurekaé€šè¿‡â€œè‡ªæˆ‘ä¿æŠ¤æ¨¡å¼â€æ¥è§£å†³è¿™ä¸ªé—®é¢˜â€”â€”å½“EurekaServerèŠ‚ç‚¹åœ¨çŸ­æ—¶é—´å†…ä¸¢å¤±è¿‡å¤šå®¢æˆ·ç«¯æ—¶ï¼ˆå¯èƒ½å‘ç”Ÿäº†ç½‘ç»œåˆ†åŒºæ•…éšœï¼‰ï¼Œé‚£ä¹ˆè¿™ä¸ªèŠ‚ç‚¹å°±ä¼šè¿›å…¥è‡ªæˆ‘ä¿æŠ¤æ¨¡å¼ã€‚</p><figure><img src="https://xcy-fcblog-1304336794.cos.ap-nanjing.myqcloud.com/posts/SpringCloud/image-20230422195535625.png" alt="image-20230422195535625" tabindex="0" loading="lazy"><figcaption>image-20230422195535625</figcaption></figure><p>åœ¨è‡ªæˆ‘ä¿æŠ¤æ¨¡å¼ä¸­ï¼ŒEureka Serverä¼šä¿æŠ¤æœåŠ¡æ³¨å†Œè¡¨ä¸­çš„ä¿¡æ¯ï¼Œä¸å†æ³¨é”€ä»»ä½•æœåŠ¡å®ä¾‹ã€‚ å®ƒçš„è®¾è®¡å“²å­¦å°±æ˜¯å®å¯ä¿ç•™é”™è¯¯çš„æœåŠ¡æ³¨å†Œä¿¡æ¯ï¼Œä¹Ÿä¸ç›²ç›®æ³¨é”€ä»»ä½•å¯èƒ½å¥åº·çš„æœåŠ¡å®ä¾‹ã€‚ä¸€å¥è¯è®²è§£ï¼šå¥½æ­»ä¸å¦‚èµ–æ´»ç€</p><p>ç»¼ä¸Šï¼Œè‡ªæˆ‘ä¿æŠ¤æ¨¡å¼æ˜¯ä¸€ç§åº”å¯¹ç½‘ç»œå¼‚å¸¸çš„å®‰å…¨ä¿æŠ¤æªæ–½ã€‚å®ƒçš„æ¶æ„å“²å­¦æ˜¯å®å¯åŒæ—¶ä¿ç•™æ‰€æœ‰å¾®æœåŠ¡ï¼ˆå¥åº·çš„å¾®æœåŠ¡å’Œä¸å¥åº·çš„å¾®æœåŠ¡éƒ½ä¼šä¿ç•™ï¼‰ä¹Ÿä¸ç›²ç›®æ³¨é”€ä»»ä½•å¥åº·çš„å¾®æœåŠ¡ã€‚ä½¿ç”¨è‡ªæˆ‘ä¿æŠ¤æ¨¡å¼ï¼Œå¯ä»¥è®©Eurekaé›†ç¾¤æ›´åŠ çš„å¥å£®ã€ç¨³å®šã€‚</p><h2 id="äºŒã€zookeeperæœåŠ¡æ³¨å†Œä¸å‘ç°" tabindex="-1"><a class="header-anchor" href="#äºŒã€zookeeperæœåŠ¡æ³¨å†Œä¸å‘ç°" aria-hidden="true">#</a> äºŒã€ZookeeperæœåŠ¡æ³¨å†Œä¸å‘ç°</h2><p>å› ä¸ºEurekaå·²ç»åœæ­¢æ›´æ–°äº†ï¼Œæ‰€ä»¥SpringCloudæ•´åˆäº†Zookeeperä»£æ›¿Eureka</p><h3 id="_1ã€æ³¨å†Œä¸­å¿ƒzookeeper" tabindex="-1"><a class="header-anchor" href="#_1ã€æ³¨å†Œä¸­å¿ƒzookeeper" aria-hidden="true">#</a> 1ã€æ³¨å†Œä¸­å¿ƒZookeeper</h3><p>æ³¨å†Œä¸­å¿ƒZookeeperæ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼åè°ƒå·¥å…·ï¼Œå¯ä»¥å®ç°æ³¨å†Œä¸­å¿ƒåŠŸèƒ½</p><p>å…³é—­LinuxæœåŠ¡å™¨é˜²ç«å¢™åå¯åŠ¨ZookeeperæœåŠ¡å™¨</p><p>zookeeperæœåŠ¡å™¨å–ä»£EurekaæœåŠ¡å™¨ï¼Œzkä½œä¸ºæœåŠ¡æ³¨å†Œä¸­å¿ƒ</p><h3 id="_2ã€æœåŠ¡æä¾›è€…" tabindex="-1"><a class="header-anchor" href="#_2ã€æœåŠ¡æä¾›è€…" aria-hidden="true">#</a> 2ã€æœåŠ¡æä¾›è€…</h3><h3 id="_3ã€æœåŠ¡æ¶ˆè´¹è€…" tabindex="-1"><a class="header-anchor" href="#_3ã€æœåŠ¡æ¶ˆè´¹è€…" aria-hidden="true">#</a> 3ã€æœåŠ¡æ¶ˆè´¹è€…</h3><h2 id="ä¸‰ã€consulæœåŠ¡æ³¨å†Œä¸å‘ç°" tabindex="-1"><a class="header-anchor" href="#ä¸‰ã€consulæœåŠ¡æ³¨å†Œä¸å‘ç°" aria-hidden="true">#</a> ä¸‰ã€ConsulæœåŠ¡æ³¨å†Œä¸å‘ç°</h2><h2 id="å››ã€ribbonè´Ÿè½½å‡è¡¡æœåŠ¡è°ƒç”¨" tabindex="-1"><a class="header-anchor" href="#å››ã€ribbonè´Ÿè½½å‡è¡¡æœåŠ¡è°ƒç”¨" aria-hidden="true">#</a> å››ã€Ribbonè´Ÿè½½å‡è¡¡æœåŠ¡è°ƒç”¨</h2><h2 id="äº”ã€openfeignæœåŠ¡æ¥å£è°ƒç”¨" tabindex="-1"><a class="header-anchor" href="#äº”ã€openfeignæœåŠ¡æ¥å£è°ƒç”¨" aria-hidden="true">#</a> äº”ã€OpenFeignæœåŠ¡æ¥å£è°ƒç”¨</h2><h2 id="å…­ã€hystrixæ–­è·¯å™¨" tabindex="-1"><a class="header-anchor" href="#å…­ã€hystrixæ–­è·¯å™¨" aria-hidden="true">#</a> å…­ã€Hystrixæ–­è·¯å™¨</h2><h2 id="ä¸ƒã€zuulè·¯ç”±ç½‘å…³" tabindex="-1"><a class="header-anchor" href="#ä¸ƒã€zuulè·¯ç”±ç½‘å…³" aria-hidden="true">#</a> ä¸ƒã€zuulè·¯ç”±ç½‘å…³</h2><h2 id="å…«ã€gatewayç½‘å…³" tabindex="-1"><a class="header-anchor" href="#å…«ã€gatewayç½‘å…³" aria-hidden="true">#</a> å…«ã€GateWayç½‘å…³</h2><p>å®˜ç½‘ï¼š<a href="https://cloud.spring.io/spring-cloud-static/spring-cloud-gateway/2.2.1.RELEASE/reference/html/" target="_blank" rel="noopener noreferrer">https://cloud.spring.io/spring-cloud-static/spring-cloud-gateway/2.2.1.RELEASE/reference/html/<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h3 id="_1ã€æ¦‚è¿°" tabindex="-1"><a class="header-anchor" href="#_1ã€æ¦‚è¿°" aria-hidden="true">#</a> 1ã€æ¦‚è¿°</h3><p>Gatewayæ˜¯åœ¨Springç”Ÿæ€ç³»ç»Ÿä¹‹ä¸Šæ„å»ºçš„APIç½‘å…³æœåŠ¡ï¼ŒåŸºäºSpring 5ï¼ŒSpring Boot 2å’Œ Project Reactorç­‰æŠ€æœ¯ã€‚ Gatewayæ—¨åœ¨æä¾›ä¸€ç§ç®€å•è€Œæœ‰æ•ˆçš„æ–¹å¼æ¥å¯¹APIè¿›è¡Œè·¯ç”±ï¼Œä»¥åŠæä¾›ä¸€äº›å¼ºå¤§çš„è¿‡æ»¤å™¨åŠŸèƒ½ï¼Œ ä¾‹å¦‚ï¼šç†”æ–­ã€é™æµã€é‡è¯•ç­‰</p><p>Gatewayæ˜¯åœ¨Springç”Ÿæ€ç³»ç»Ÿä¹‹ä¸Šæ„å»ºçš„APIç½‘å…³æœåŠ¡ï¼ŒåŸºäºSpring 5ï¼ŒSpring Boot 2å’Œ Project Reactorç­‰æŠ€æœ¯ã€‚ Gatewayæ—¨åœ¨æä¾›ä¸€ç§ç®€å•è€Œæœ‰æ•ˆçš„æ–¹å¼æ¥å¯¹APIè¿›è¡Œè·¯ç”±ï¼Œä»¥åŠæä¾›ä¸€äº›å¼ºå¤§çš„è¿‡æ»¤å™¨åŠŸèƒ½ï¼Œ ä¾‹å¦‚ï¼šç†”æ–­ã€é™æµã€é‡è¯•ç­‰</p><p>SpringCloud Gateway æ˜¯ Spring Cloud çš„ä¸€ä¸ªå…¨æ–°é¡¹ç›®ï¼ŒåŸºäº Spring 5.0+Spring Boot 2.0 å’Œ Project Reactor ç­‰æŠ€æœ¯å¼€å‘çš„ç½‘å…³ï¼Œå®ƒæ—¨åœ¨ä¸ºå¾®æœåŠ¡æ¶æ„æä¾›ä¸€ç§ç®€å•æœ‰æ•ˆçš„ç»Ÿä¸€çš„ API è·¯ç”±ç®¡ç†æ–¹å¼ã€‚</p><p>SpringCloud Gateway ä½œä¸º Spring Cloud ç”Ÿæ€ç³»ç»Ÿä¸­çš„ç½‘å…³ï¼Œç›®æ ‡æ˜¯æ›¿ä»£ Zuulï¼Œåœ¨Spring Cloud 2.0ä»¥ä¸Šç‰ˆæœ¬ä¸­ï¼Œæ²¡æœ‰å¯¹æ–°ç‰ˆæœ¬çš„Zuul 2.0ä»¥ä¸Šæœ€æ–°é«˜æ€§èƒ½ç‰ˆæœ¬è¿›è¡Œé›†æˆï¼Œä»ç„¶è¿˜æ˜¯ä½¿ç”¨çš„Zuul 1.xéReactoræ¨¡å¼çš„è€ç‰ˆæœ¬ã€‚è€Œä¸ºäº†æå‡ç½‘å…³çš„æ€§èƒ½ï¼ŒSpringCloud Gatewayæ˜¯åŸºäºWebFluxæ¡†æ¶å®ç°çš„ï¼Œè€ŒWebFluxæ¡†æ¶åº•å±‚åˆ™ä½¿ç”¨äº†é«˜æ€§èƒ½çš„Reactoræ¨¡å¼é€šä¿¡æ¡†æ¶Nettyã€‚</p><p>Spring Cloud Gatewayçš„ç›®æ ‡æä¾›ç»Ÿä¸€çš„è·¯ç”±æ–¹å¼ä¸”åŸºäº Filter é“¾çš„æ–¹å¼æä¾›äº†ç½‘å…³åŸºæœ¬çš„åŠŸèƒ½ï¼Œä¾‹å¦‚ï¼šå®‰å…¨ï¼Œç›‘æ§/æŒ‡æ ‡ï¼Œå’Œé™æµã€‚</p><p>SpringCloud Gateway ä½¿ç”¨çš„Webfluxä¸­çš„reactor-nettyå“åº”å¼ç¼–ç¨‹ç»„ä»¶ï¼Œåº•å±‚ä½¿ç”¨äº†Nettyé€šè®¯æ¡†æ¶ã€‚</p><p>æ¶æ„å›¾ï¼š</p><figure><img src="https://xcy-fcblog-1304336794.cos.ap-nanjing.myqcloud.com/posts/SpringCloud/GateWayç½‘å…³æ¶æ„å›¾.png" alt="GateWayç½‘å…³æ¶æ„å›¾" tabindex="0" loading="lazy"><figcaption>GateWayç½‘å…³æ¶æ„å›¾</figcaption></figure><p>ä½œç”¨ï¼š</p><ul><li>åå‘ä»£ç†</li><li>é‰´æƒ</li><li>æµé‡æ§åˆ¶</li><li>ç†”æ–­</li><li>æ—¥å¿—ç›‘æ§</li><li>ç­‰ç­‰</li></ul><p>å¾®æœåŠ¡æ¶æ„ä¸­ç½‘å…³åœ¨å“ªé‡Œï¼Ÿ</p><figure><img src="https://xcy-fcblog-1304336794.cos.ap-nanjing.myqcloud.com/posts/SpringCloud/å¾®æœåŠ¡ä¸­ç½‘å…³çš„ä½ç½®.png" alt="å¾®æœåŠ¡ä¸­ç½‘å…³çš„ä½ç½®" tabindex="0" loading="lazy"><figcaption>å¾®æœåŠ¡ä¸­ç½‘å…³çš„ä½ç½®</figcaption></figure><h3 id="_2ã€ä¸‰å¤§æ ¸å¿ƒæ¦‚å¿µ" tabindex="-1"><a class="header-anchor" href="#_2ã€ä¸‰å¤§æ ¸å¿ƒæ¦‚å¿µ" aria-hidden="true">#</a> 2ã€ä¸‰å¤§æ ¸å¿ƒæ¦‚å¿µ</h3><ul><li><p>Rotuteï¼ˆè·¯ç”±ï¼‰ï¼šè·¯ç”±æ˜¯æ„å»ºç½‘å…³çš„åŸºæœ¬æ¨¡å—ï¼Œå®ƒç”±IDï¼Œç›®æ ‡URIï¼Œä¸€ç³»åˆ—çš„æ–­è¨€å’Œè¿‡æ»¤å™¨ç»„æˆï¼Œå¦‚æœæ–­è¨€ä¸ºtrueåˆ™åŒ¹é…è¯¥è·¯ç”±</p></li><li><p>Predicateï¼ˆæ–­è¨€ï¼‰ï¼šå‚è€ƒçš„æ˜¯Java8çš„java.util.function.Predicate å¼€å‘äººå‘˜å¯ä»¥åŒ¹é…HTTPè¯·æ±‚ä¸­çš„æ‰€æœ‰å†…å®¹(ä¾‹å¦‚è¯·æ±‚å¤´æˆ–è¯·æ±‚å‚æ•°)ï¼Œ<code>å¦‚æœè¯·æ±‚ä¸æ–­è¨€ç›¸åŒ¹é…åˆ™è¿›è¡Œè·¯ç”±</code></p></li><li><p>Filterï¼ˆè¿‡æ»¤ï¼‰ï¼šæŒ‡çš„æ˜¯Springæ¡†æ¶ä¸­GatewayFilterçš„å®ä¾‹ï¼Œä½¿ç”¨è¿‡æ»¤å™¨ï¼Œå¯ä»¥åœ¨è¯·æ±‚è¢«è·¯ç”±å‰æˆ–è€…ä¹‹åå¯¹è¯·æ±‚è¿›è¡Œä¿®æ”¹ã€‚</p></li></ul><figure><img src="https://xcy-fcblog-1304336794.cos.ap-nanjing.myqcloud.com/posts/SpringCloud/GateWayä¸‰å¤§æ ¸å¿ƒæ¦‚å¿µæ€»ä½“.png" alt="GateWayä¸‰å¤§æ ¸å¿ƒæ¦‚å¿µæ€»ä½“" tabindex="0" loading="lazy"><figcaption>GateWayä¸‰å¤§æ ¸å¿ƒæ¦‚å¿µæ€»ä½“</figcaption></figure><p>æ€»ä½“ï¼šwebè¯·æ±‚ï¼Œé€šè¿‡ä¸€äº›åŒ¹é…æ¡ä»¶ï¼Œå®šä½åˆ°çœŸæ­£çš„æœåŠ¡èŠ‚ç‚¹ã€‚å¹¶åœ¨è¿™ä¸ªè½¬å‘è¿‡ç¨‹çš„å‰åï¼Œè¿›è¡Œä¸€äº›ç²¾ç»†åŒ–æ§åˆ¶ã€‚ predicateå°±æ˜¯æˆ‘ä»¬çš„åŒ¹é…æ¡ä»¶ï¼›è€Œfilterï¼Œå°±å¯ä»¥ç†è§£ä¸ºä¸€ä¸ªæ— æ‰€ä¸èƒ½çš„æ‹¦æˆªå™¨ã€‚æœ‰äº†è¿™ä¸¤ä¸ªå…ƒç´ ï¼Œå†åŠ ä¸Šç›®æ ‡uriï¼Œå°±å¯ä»¥å®ç°ä¸€ä¸ªå…·ä½“çš„è·¯ç”±äº†</p><h3 id="_3ã€gatewayå·¥ä½œæµç¨‹" tabindex="-1"><a class="header-anchor" href="#_3ã€gatewayå·¥ä½œæµç¨‹" aria-hidden="true">#</a> 3ã€GateWayå·¥ä½œæµç¨‹</h3><figure><img src="https://xcy-fcblog-1304336794.cos.ap-nanjing.myqcloud.com/posts/SpringCloud/GateWayå·¥ä½œæµç¨‹.png" alt="GateWayå·¥ä½œæµç¨‹" tabindex="0" loading="lazy"><figcaption>GateWayå·¥ä½œæµç¨‹</figcaption></figure><p>æ ¸å¿ƒé€»è¾‘ï¼š<code>è·¯ç”±è½¬å‘+æ‰§è¡Œè¿‡æ»¤å™¨é“¾</code></p><h3 id="_4ã€å…¥é—¨é…ç½®" tabindex="-1"><a class="header-anchor" href="#_4ã€å…¥é—¨é…ç½®" aria-hidden="true">#</a> 4ã€å…¥é—¨é…ç½®</h3><p>å¼•å…¥mavenä¾èµ–ï¼š</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token comment">&lt;!--gateway--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-cloud-starter-gateway<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç¼–å†™ymlé…ç½®æ–‡ä»¶ï¼š</p><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code> 
<span class="token key atrule">server</span><span class="token punctuation">:</span>
  <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">9527</span>

<span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">application</span><span class="token punctuation">:</span>
    <span class="token key atrule">name</span><span class="token punctuation">:</span> cloud<span class="token punctuation">-</span>gateway
  <span class="token key atrule">cloud</span><span class="token punctuation">:</span>
    <span class="token key atrule">gateway</span><span class="token punctuation">:</span>
      <span class="token key atrule">routes</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> payment_routh <span class="token comment">#payment_route   #è·¯ç”±çš„IDï¼Œæ²¡æœ‰å›ºå®šè§„åˆ™ä½†è¦æ±‚å”¯ä¸€ï¼Œå»ºè®®é…åˆæœåŠ¡å</span>
          <span class="token key atrule">uri</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//localhost<span class="token punctuation">:</span><span class="token number">8001</span>          <span class="token comment">#åŒ¹é…åæä¾›æœåŠ¡çš„è·¯ç”±åœ°å€</span>
          <span class="token key atrule">predicates</span><span class="token punctuation">:</span>
            <span class="token punctuation">-</span> Path=/payment/get/<span class="token important">**</span>         <span class="token comment"># æ–­è¨€ï¼Œè·¯å¾„ç›¸åŒ¹é…çš„è¿›è¡Œè·¯ç”±</span>

        <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> payment_routh2 <span class="token comment">#payment_route  #è·¯ç”±çš„IDï¼Œæ²¡æœ‰å›ºå®šè§„åˆ™ä½†è¦æ±‚å”¯ä¸€ï¼Œå»ºè®®é…åˆæœåŠ¡å</span>
          <span class="token key atrule">uri</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//localhost<span class="token punctuation">:</span><span class="token number">8001</span>          <span class="token comment">#åŒ¹é…åæä¾›æœåŠ¡çš„è·¯ç”±åœ°å€</span>
          <span class="token key atrule">predicates</span><span class="token punctuation">:</span>
            <span class="token punctuation">-</span> Path=/payment/lb/<span class="token important">**</span>         <span class="token comment"># æ–­è¨€ï¼Œè·¯å¾„ç›¸åŒ¹é…çš„è¿›è¡Œè·¯ç”±</span>

<span class="token key atrule">eureka</span><span class="token punctuation">:</span>
  <span class="token key atrule">instance</span><span class="token punctuation">:</span>
    <span class="token key atrule">hostname</span><span class="token punctuation">:</span> cloud<span class="token punctuation">-</span>gateway<span class="token punctuation">-</span>service
  <span class="token key atrule">client</span><span class="token punctuation">:</span> <span class="token comment">#æœåŠ¡æä¾›è€…provideræ³¨å†Œè¿›eurekaæœåŠ¡åˆ—è¡¨å†…</span>
    <span class="token key atrule">service-url</span><span class="token punctuation">:</span>
      <span class="token key atrule">register-with-eureka</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
      <span class="token key atrule">fetch-registry</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
      <span class="token key atrule">defaultZone</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//eureka7001.com<span class="token punctuation">:</span>7001/eureka
 

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è®¿é—®è¯´æ˜ï¼š</p><figure><img src="https://xcy-fcblog-1304336794.cos.ap-nanjing.myqcloud.com/posts/SpringCloud/GateWayè®¿é—®è¯´æ˜.png" alt="GateWayè®¿é—®è¯´æ˜" tabindex="0" loading="lazy"><figcaption>GateWayè®¿é—®è¯´æ˜</figcaption></figure><p>æ·»åŠ ç½‘å…³åå¯é€šè¿‡<a href="http://localhost:9527/%E8%BF%9B%E8%A1%8C%E6%9C%8D%E5%8A%A1%E8%AE%BF%E9%97%AE" target="_blank" rel="noopener noreferrer">http://localhost:9527/è¿›è¡ŒæœåŠ¡è®¿é—®<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p>GateWayè¿˜å…·æœ‰å¦ä¸€ç§é…ç½®æ–¹å¼ï¼Œå°±æ˜¯åœ¨ä»£ç ä¸­æ³¨å…¥RouteLocatorçš„Bean</p><p>å®˜ç½‘ä¸­æ˜¯è¿™ä¹ˆå†™çš„</p><figure><img src="https://xcy-fcblog-1304336794.cos.ap-nanjing.myqcloud.com/posts/SpringCloud/GateWayä»£ç æ³¨å…¥é…ç½®æ–¹å¼.png" alt="GateWayä»£ç æ³¨å…¥é…ç½®æ–¹å¼" tabindex="0" loading="lazy"><figcaption>GateWayä»£ç æ³¨å…¥é…ç½®æ–¹å¼</figcaption></figure><p>ç¤ºä¾‹å¦‚ä¸‹ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">GateWayConfig</span>
<span class="token punctuation">{</span>
    <span class="token doc-comment comment">/**
     * é…ç½®äº†ä¸€ä¸ªidä¸ºroute-nameçš„è·¯ç”±è§„åˆ™ï¼Œ
     * å½“è®¿é—®åœ°å€ http://localhost:9527/guoneiæ—¶ä¼šè‡ªåŠ¨è½¬å‘åˆ°åœ°å€ï¼šhttp://news.baidu.com/guonei
     * <span class="token keyword">@param</span> <span class="token parameter">builder</span>
     * <span class="token keyword">@return</span>
     */</span>
    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">RouteLocator</span> <span class="token function">customRouteLocator</span><span class="token punctuation">(</span><span class="token class-name">RouteLocatorBuilder</span> builder<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token class-name">RouteLocatorBuilder<span class="token punctuation">.</span>Builder</span> routes <span class="token operator">=</span> builder<span class="token punctuation">.</span><span class="token function">routes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        routes<span class="token punctuation">.</span><span class="token function">route</span><span class="token punctuation">(</span><span class="token string">&quot;path_route_atguigu&quot;</span><span class="token punctuation">,</span> r <span class="token operator">-&gt;</span> r<span class="token punctuation">.</span><span class="token function">path</span><span class="token punctuation">(</span><span class="token string">&quot;/guonei&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">uri</span><span class="token punctuation">(</span><span class="token string">&quot;http://news.baidu.com/guonei&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">return</span> routes<span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>
    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">RouteLocator</span> <span class="token function">customRouteLocator2</span><span class="token punctuation">(</span><span class="token class-name">RouteLocatorBuilder</span> builder<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token class-name">RouteLocatorBuilder<span class="token punctuation">.</span>Builder</span> routes <span class="token operator">=</span> builder<span class="token punctuation">.</span><span class="token function">routes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        routes<span class="token punctuation">.</span><span class="token function">route</span><span class="token punctuation">(</span><span class="token string">&quot;path_route_atguigu2&quot;</span><span class="token punctuation">,</span> r <span class="token operator">-&gt;</span> r<span class="token punctuation">.</span><span class="token function">path</span><span class="token punctuation">(</span><span class="token string">&quot;/guoji&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">uri</span><span class="token punctuation">(</span><span class="token string">&quot;http://news.baidu.com/guoji&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> routes<span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_5ã€é€šè¿‡å¾®æœåŠ¡åå®ç°åŠ¨æ€è·¯ç”±" tabindex="-1"><a class="header-anchor" href="#_5ã€é€šè¿‡å¾®æœåŠ¡åå®ç°åŠ¨æ€è·¯ç”±" aria-hidden="true">#</a> 5ã€é€šè¿‡å¾®æœåŠ¡åå®ç°åŠ¨æ€è·¯ç”±</h3><p>é»˜è®¤æƒ…å†µä¸‹Gatewayä¼šæ ¹æ®æ³¨å†Œä¸­å¿ƒæ³¨å†Œçš„æœåŠ¡åˆ—è¡¨ï¼Œä»¥æ³¨å†Œä¸­å¿ƒä¸Šå¾®æœåŠ¡åä¸ºè·¯å¾„åˆ›å»º<mark>åŠ¨æ€è·¯ç”±è¿›è¡Œè½¬å‘ï¼Œä»è€Œå®ç°åŠ¨æ€è·¯ç”±çš„åŠŸèƒ½</mark></p><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¿®æ”¹ymlæ–‡ä»¶å³å¯å®Œæˆå®ç°åŠ¨æ€è·¯ç”±ï¼š</p><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">server</span><span class="token punctuation">:</span>
  <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">9527</span>

<span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">application</span><span class="token punctuation">:</span>
    <span class="token key atrule">name</span><span class="token punctuation">:</span> cloud<span class="token punctuation">-</span>gateway
  <span class="token key atrule">cloud</span><span class="token punctuation">:</span>
    <span class="token key atrule">gateway</span><span class="token punctuation">:</span>
      <span class="token key atrule">discovery</span><span class="token punctuation">:</span>
        <span class="token key atrule">locator</span><span class="token punctuation">:</span>
          <span class="token key atrule">enabled</span><span class="token punctuation">:</span> <span class="token boolean important">true</span> <span class="token comment">#å¼€å¯ä»æ³¨å†Œä¸­å¿ƒåŠ¨æ€åˆ›å»ºè·¯ç”±çš„åŠŸèƒ½ï¼Œåˆ©ç”¨å¾®æœåŠ¡åè¿›è¡Œè·¯ç”±</span>
      <span class="token key atrule">routes</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> payment_routh <span class="token comment">#payment_route  #è·¯ç”±çš„IDï¼Œæ²¡æœ‰å›ºå®šè§„åˆ™ä½†è¦æ±‚å”¯ä¸€ï¼Œå»ºè®®é…åˆæœåŠ¡å</span>
          <span class="token comment"># uri: http://localhost:8001          #åŒ¹é…åæä¾›æœåŠ¡çš„è·¯ç”±åœ°å€</span>
          <span class="token key atrule">uri</span><span class="token punctuation">:</span> lb<span class="token punctuation">:</span>//cloud<span class="token punctuation">-</span>payment<span class="token punctuation">-</span>service <span class="token comment">#åŒ¹é…åæä¾›æœåŠ¡çš„è·¯ç”±åœ°å€</span>
          <span class="token key atrule">predicates</span><span class="token punctuation">:</span>
            <span class="token punctuation">-</span> Path=/payment/get/<span class="token important">**</span>         <span class="token comment"># æ–­è¨€ï¼Œè·¯å¾„ç›¸åŒ¹é…çš„è¿›è¡Œè·¯ç”±</span>

        <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> payment_routh2 <span class="token comment">#payment_route  #è·¯ç”±çš„IDï¼Œæ²¡æœ‰å›ºå®šè§„åˆ™ä½†è¦æ±‚å”¯ä¸€ï¼Œå»ºè®®é…åˆæœåŠ¡å</span>
          <span class="token comment"># uri: http://localhost:8001          #åŒ¹é…åæä¾›æœåŠ¡çš„è·¯ç”±åœ°å€</span>
          <span class="token key atrule">uri</span><span class="token punctuation">:</span> lb<span class="token punctuation">:</span>//cloud<span class="token punctuation">-</span>payment<span class="token punctuation">-</span>service <span class="token comment">#åŒ¹é…åæä¾›æœåŠ¡çš„è·¯ç”±åœ°å€</span>
          <span class="token key atrule">predicates</span><span class="token punctuation">:</span>
            <span class="token punctuation">-</span> Path=/payment/lb/<span class="token important">**</span>         <span class="token comment"># æ–­è¨€ï¼Œè·¯å¾„ç›¸åŒ¹é…çš„è¿›è¡Œè·¯ç”±</span>

<span class="token key atrule">eureka</span><span class="token punctuation">:</span>
  <span class="token key atrule">instance</span><span class="token punctuation">:</span>
    <span class="token key atrule">hostname</span><span class="token punctuation">:</span> cloud<span class="token punctuation">-</span>gateway<span class="token punctuation">-</span>service
  <span class="token key atrule">client</span><span class="token punctuation">:</span> <span class="token comment">#æœåŠ¡æä¾›è€…provideræ³¨å†Œè¿›eurekaæœåŠ¡åˆ—è¡¨å†…</span>
    <span class="token key atrule">service-url</span><span class="token punctuation">:</span>
      <span class="token key atrule">register-with-eureka</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
      <span class="token key atrule">fetch-registry</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
      <span class="token key atrule">defaultZone</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//eureka7001.com<span class="token punctuation">:</span>7001/eureka
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é…ç½®å®Œæˆåï¼Œå¯ä»¥é€šè¿‡<a href="http://localhost:9527" target="_blank" rel="noopener noreferrer">http://localhost:9527<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> + æ¥å£è·¯å¾„è®¿é—®æµ‹è¯•</p><h3 id="_6ã€predicateçš„ä½¿ç”¨" tabindex="-1"><a class="header-anchor" href="#_6ã€predicateçš„ä½¿ç”¨" aria-hidden="true">#</a> 6ã€Predicateçš„ä½¿ç”¨</h3><p>Predicateæ˜¯ä»€ä¹ˆï¼Ÿ</p><p>åœ¨å¯åŠ¨gatewayçš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å¯åŠ¨çš„æ—¥å¿—ä¸­çœ‹åˆ°å¦‚ä¸‹çš„ä¿¡æ¯ï¼š</p><figure><img src="https://xcy-fcblog-1304336794.cos.ap-nanjing.myqcloud.com/posts/SpringCloud/é¡¹ç›®å¯åŠ¨æ‰“å°çš„gatewayä¿¡æ¯.png" alt="é¡¹ç›®å¯åŠ¨æ‰“å°çš„gatewayä¿¡æ¯" tabindex="0" loading="lazy"><figcaption>é¡¹ç›®å¯åŠ¨æ‰“å°çš„gatewayä¿¡æ¯</figcaption></figure><p>Route Predicate Factoriesåœ¨å®˜ç½‘ä¸Šæ˜¯è¿™ä¹ˆè¯´çš„ï¼š</p><figure><img src="https://xcy-fcblog-1304336794.cos.ap-nanjing.myqcloud.com/posts/SpringCloud/Route Predicate Factories.png" alt="Route Predicate Factories" tabindex="0" loading="lazy"><figcaption>Route Predicate Factories</figcaption></figure><p>Spring Cloud Gatewayå°†è·¯ç”±åŒ¹é…ä½œä¸ºSpring WebFlux HandlerMappingåŸºç¡€æ¶æ„çš„ä¸€éƒ¨åˆ†ã€‚Spring Cloud GatewayåŒ…æ‹¬è®¸å¤šå†…ç½®çš„Route Predicateå·¥å‚ã€‚æ‰€æœ‰è¿™äº›Predicateéƒ½ä¸HTTPè¯·æ±‚çš„ä¸åŒå±æ€§åŒ¹é…ã€‚å¤šä¸ªRoute Predicateå·¥å‚å¯ä»¥è¿›è¡Œç»„åˆ</p><p>è€Œå¸¸ç”¨çš„<mark>å¸¸ç”¨çš„Route Predicate</mark>æœ‰ï¼š</p><ul><li>After Route Predicate</li><li>Before Route Predicate</li><li>Between Route Predicate</li><li>Cookie Route Predicate</li><li>Header Route Predicate</li><li>Host Route Predicate</li><li>Method Route Predicate</li><li>Path Route Predicate</li><li>Query Route Predicate</li></ul><p>å¯ä»¥åœ¨ymlé…ç½®æ–‡ä»¶ä¸­è¿›è¡Œé…ç½®ï¼š</p><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code> <span class="token key atrule">server</span><span class="token punctuation">:</span>
  <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">9527</span>

<span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">application</span><span class="token punctuation">:</span>
    <span class="token key atrule">name</span><span class="token punctuation">:</span> cloud<span class="token punctuation">-</span>gateway
  <span class="token key atrule">cloud</span><span class="token punctuation">:</span>
    <span class="token key atrule">gateway</span><span class="token punctuation">:</span>
      <span class="token key atrule">discovery</span><span class="token punctuation">:</span>
        <span class="token key atrule">locator</span><span class="token punctuation">:</span>
          <span class="token key atrule">enabled</span><span class="token punctuation">:</span> <span class="token boolean important">true</span> <span class="token comment">#å¼€å¯ä»æ³¨å†Œä¸­å¿ƒåŠ¨æ€åˆ›å»ºè·¯ç”±çš„åŠŸèƒ½</span>
      <span class="token key atrule">routes</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> payment_routh <span class="token comment">#payment_route    #è·¯ç”±çš„IDï¼Œæ²¡æœ‰å›ºå®šè§„åˆ™ä½†è¦æ±‚å”¯ä¸€ï¼Œå»ºè®®é…åˆæœåŠ¡å</span>
          <span class="token comment"># uri: http://localhost:8001          #åŒ¹é…åæä¾›æœåŠ¡çš„è·¯ç”±åœ°å€</span>
          <span class="token key atrule">uri</span><span class="token punctuation">:</span> lb<span class="token punctuation">:</span>//cloud<span class="token punctuation">-</span>payment<span class="token punctuation">-</span>service <span class="token comment">#åŒ¹é…åæä¾›æœåŠ¡çš„è·¯ç”±åœ°å€</span>
          <span class="token key atrule">predicates</span><span class="token punctuation">:</span>
            <span class="token punctuation">-</span> Path=/payment/get/<span class="token important">**</span>         <span class="token comment"># æ–­è¨€ï¼Œè·¯å¾„ç›¸åŒ¹é…çš„è¿›è¡Œè·¯ç”±</span>

        <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> payment_routh2 <span class="token comment">#payment_route    #è·¯ç”±çš„IDï¼Œæ²¡æœ‰å›ºå®šè§„åˆ™ä½†è¦æ±‚å”¯ä¸€ï¼Œå»ºè®®é…åˆæœåŠ¡å</span>
          <span class="token comment"># uri: http://localhost:8001          #åŒ¹é…åæä¾›æœåŠ¡çš„è·¯ç”±åœ°å€</span>
          <span class="token key atrule">uri</span><span class="token punctuation">:</span> lb<span class="token punctuation">:</span>//cloud<span class="token punctuation">-</span>payment<span class="token punctuation">-</span>service <span class="token comment">#åŒ¹é…åæä¾›æœåŠ¡çš„è·¯ç”±åœ°å€</span>
          <span class="token key atrule">predicates</span><span class="token punctuation">:</span>
            <span class="token punctuation">-</span> Path=/payment/lb/<span class="token important">**</span>         <span class="token comment"># æ–­è¨€ï¼Œè·¯å¾„ç›¸åŒ¹é…çš„è¿›è¡Œè·¯ç”±</span>
            <span class="token punctuation">-</span> After=2020<span class="token punctuation">-</span>02<span class="token punctuation">-</span>05T15<span class="token punctuation">:</span>10<span class="token punctuation">:</span>03.685+08<span class="token punctuation">:</span>00<span class="token punctuation">[</span>Asia/Shanghai<span class="token punctuation">]</span>         <span class="token comment"># æ–­è¨€ï¼Œè·¯å¾„ç›¸åŒ¹é…çš„è¿›è¡Œè·¯ç”±</span>
            <span class="token comment">#- Before=2020-02-05T15:10:03.685+08:00[Asia/Shanghai]         # æ–­è¨€ï¼Œè·¯å¾„ç›¸åŒ¹é…çš„è¿›è¡Œè·¯ç”±</span>
            <span class="token comment">#- Between=2020-02-02T17:45:06.206+08:00[Asia/Shanghai],2020-03-25T18:59:06.206+08:00[Asia/Shanghai]</span>
            <span class="token comment">#- Cookie=username,zzyy</span>
            <span class="token comment">#- Header=X-Request-Id, \d+  # è¯·æ±‚å¤´è¦æœ‰X-Request-Idå±æ€§å¹¶ä¸”å€¼ä¸ºæ•´æ•°çš„æ­£åˆ™è¡¨è¾¾å¼</span>
            <span class="token comment">#- Host=**.atguigu.com</span>
            <span class="token punctuation">-</span> Method=GET
            <span class="token punctuation">-</span> Query=username<span class="token punctuation">,</span> \d+  <span class="token comment"># è¦æœ‰å‚æ•°åusernameå¹¶ä¸”å€¼è¿˜è¦æ˜¯æ•´æ•°æ‰èƒ½è·¯ç”±</span>

<span class="token key atrule">eureka</span><span class="token punctuation">:</span>
  <span class="token key atrule">instance</span><span class="token punctuation">:</span>
    <span class="token key atrule">hostname</span><span class="token punctuation">:</span> cloud<span class="token punctuation">-</span>gateway<span class="token punctuation">-</span>service
  <span class="token key atrule">client</span><span class="token punctuation">:</span> <span class="token comment">#æœåŠ¡æä¾›è€…provideræ³¨å†Œè¿›eurekaæœåŠ¡åˆ—è¡¨å†…</span>
    <span class="token key atrule">service-url</span><span class="token punctuation">:</span>
      <span class="token key atrule">register-with-eureka</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
      <span class="token key atrule">fetch-registry</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
      <span class="token key atrule">defaultZone</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//eureka7001.com<span class="token punctuation">:</span>7001/eureka
<span class="token comment">#idï¼šæˆ‘ä»¬è‡ªå®šä¹‰çš„è·¯ç”± IDï¼Œä¿æŒå”¯ä¸€</span>
 <span class="token comment">##uriï¼šç›®æ ‡æœåŠ¡åœ°å€</span>
 <span class="token comment">##predicatesï¼šè·¯ç”±æ¡ä»¶ï¼ŒPredicateæ¥å—ä¸€ä¸ªè¾“å…¥å‚æ•°è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ã€‚</span>
 <span class="token comment">##            è¯¥å±æ€§åŒ…å«å¤šç§é»˜è®¤æ–¹æ³•æ¥å°†Predicateç»„åˆæˆå…¶ä»–å¤æ‚çš„é€»è¾‘(æ¯”å¦‚ï¼šä¸ï¼Œæˆ–ï¼Œé)</span>
 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¯´ç™½äº†ï¼ŒPredicateå°±æ˜¯ä¸ºäº†å®ç°ä¸€ç»„åŒ¹é…è§„åˆ™ï¼Œè®©è¯·æ±‚è¿‡æ¥æ‰¾åˆ°å¯¹åº”çš„Routeè¿›è¡Œå¤„ç†ã€‚</p><h3 id="_7ã€filterçš„ä½¿ç”¨" tabindex="-1"><a class="header-anchor" href="#_7ã€filterçš„ä½¿ç”¨" aria-hidden="true">#</a> 7ã€Filterçš„ä½¿ç”¨</h3><figure><img src="https://xcy-fcblog-1304336794.cos.ap-nanjing.myqcloud.com/posts/SpringCloud/Gatewayä¸­çš„Filteræ¦‚è¿°.png" alt="Gatewayä¸­çš„Filteræ¦‚è¿°" tabindex="0" loading="lazy"><figcaption>Gatewayä¸­çš„Filteræ¦‚è¿°</figcaption></figure><p>è·¯ç”±è¿‡æ»¤å™¨å¯ç”¨äºä¿®æ”¹è¿›å…¥çš„HTTPè¯·æ±‚å’Œè¿”å›çš„HTTPå“åº”ï¼Œè·¯ç”±è¿‡æ»¤å™¨åªèƒ½æŒ‡å®šè·¯ç”±è¿›è¡Œä½¿ç”¨ã€‚Spring Cloud Gateway å†…ç½®äº†å¤šç§è·¯ç”±è¿‡æ»¤å™¨ï¼Œä»–ä»¬éƒ½ç”±GatewayFilterçš„å·¥å‚ç±»æ¥äº§ç”Ÿ</p><p>Spring Cloud Gatewayçš„Filteræœ‰ä¸¤ç§ç”Ÿå‘½å‘¨æœŸï¼Œåˆ†åˆ«æ˜¯preå’Œpostã€‚åŒæ—¶æœ‰ä¸¤ç§ç§ç±»ï¼Œä¸€ç§æ˜¯å•ä¸ªè¿‡æ»¤å™¨GatewayFilterï¼Œå¦ä¸€ç§æ˜¯å…¨å±€è¿‡æ»¤å™¨GlobalFilter</p><p>ä½†ä¸€èˆ¬å¼€å‘ä¸­æ›´ä¹ æƒ¯é‡‡ç”¨è‡ªå®šä¹‰çš„å…¨å±€ç½‘å…³è¿›è¡Œè¿‡æ»¤ä»¥ç»“åˆå®é™…çš„ä¸šåŠ¡éœ€æ±‚å»å®Œæˆè¿‡æ»¤</p><h4 id="è‡ªå®šä¹‰å…¨å±€ç½‘å…³" tabindex="-1"><a class="header-anchor" href="#è‡ªå®šä¹‰å…¨å±€ç½‘å…³" aria-hidden="true">#</a> è‡ªå®šä¹‰å…¨å±€ç½‘å…³</h4><p>åˆ›å»ºå…¨å±€GateWayFilterï¼Œè®©å…¶å®ç°GlobalFilter, Orderedä¸¤ä¸ªæ¥å£ï¼Œåœ¨ä¸¤ä¸ªå®ç°ç±»ä¸­è¿›è¡Œæ“ä½œï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å…¶ä¸­è¿›è¡Œå…¨å±€æ—¥å¿—è®°å½•ï¼Œç»Ÿä¸€ç½‘å…³é‰´æƒç­‰å„ç§æ“ä½œ</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Component</span>
<span class="token annotation punctuation">@Slf4j</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyLogGateWayFilter</span> <span class="token keyword">implements</span> <span class="token class-name">GlobalFilter</span><span class="token punctuation">,</span> <span class="token class-name">Ordered</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Mono</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Void</span><span class="token punctuation">&gt;</span></span> <span class="token function">filter</span><span class="token punctuation">(</span><span class="token class-name">ServerWebExchange</span> exchange<span class="token punctuation">,</span> <span class="token class-name">GatewayFilterChain</span> chain<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//è·å–è¯·æ±‚å¤´æˆ–è€…å‚æ•°</span>
        <span class="token class-name">String</span> requestHeader <span class="token operator">=</span> exchange<span class="token punctuation">.</span><span class="token function">getRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getHeaders</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getFirst</span><span class="token punctuation">(</span><span class="token string">&quot;X-Requested-With&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//ä¸æ»¡è¶³æ¡ä»¶ï¼Œè¿›è¡Œæ“ä½œè¿”å›</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span>requestHeader<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;æ— X-Request-params&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            exchange<span class="token punctuation">.</span><span class="token function">getResponse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setStatusCode</span><span class="token punctuation">(</span><span class="token class-name">HttpStatus</span><span class="token punctuation">.</span><span class="token constant">BAD_REQUEST</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> exchange<span class="token punctuation">.</span><span class="token function">getResponse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setComplete</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">//æ»¡è¶³æ¡ä»¶æ”¾è¡Œ</span>
        <span class="token keyword">return</span> chain<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>exchange<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getOrder</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="ä¹ã€springcloud-configåˆ†å¸ƒå¼é…ç½®ä¸­å¿ƒ" tabindex="-1"><a class="header-anchor" href="#ä¹ã€springcloud-configåˆ†å¸ƒå¼é…ç½®ä¸­å¿ƒ" aria-hidden="true">#</a> ä¹ã€SpringCloud Configåˆ†å¸ƒå¼é…ç½®ä¸­å¿ƒ</h2><h3 id="_1ã€æ¦‚è¿°-1" tabindex="-1"><a class="header-anchor" href="#_1ã€æ¦‚è¿°-1" aria-hidden="true">#</a> 1ã€æ¦‚è¿°</h3><p>å®˜ç½‘ï¼š<a href="https://cloud.spring.io/spring-cloud-static/spring-cloud-config/2.2.1.RELEASE/reference/html/" target="_blank" rel="noopener noreferrer">https://cloud.spring.io/spring-cloud-static/spring-cloud-config/2.2.1.RELEASE/reference/html/<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p>å¾®æœåŠ¡æ„å‘³ç€è¦å°†å•ä½“åº”ç”¨ä¸­çš„ä¹‰åŠ¡æ‹†åˆ†æˆä¸€ä¸ªä¸ªå­æœåŠ¡ï¼Œæ¯ä¸ªæœåŠ¡çš„ç²’åº¦ç›¸å¯¹è¾ƒå°‘ï¼Œå› æ­¤ç³»ç»Ÿä¸­ä¼šå‡ºç°å¤§é‡çš„æœåŠ¡ï¼Œç”±äºæ¯ä¸ªæœåŠ¡éƒ½éœ€è¦å¿…è¦çš„é…ç½®ä¿¡æ¯æ‰èƒ½è¿è¡Œï¼Œæ‰€ä»¥ä¸€å¥—é›†ä¸­å¼çš„ã€åŠ¨æ€çš„é…ç½®ç®¡ç†è®¾æ–½æ˜¯å¿…ä¸å¯å°‘çš„ã€‚</p><p>SpringCloudæä¾›äº†ConfigServeræ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬æ¯ä¸€ä¸ªå¾®æœåŠ¡è‡ªå·±å¸¦ä¸€ä¸ªapplication.ymlï¼Œä¸Šç™¾ä¸ªé…ç½®æ–‡ä»¶çš„ç®¡ç†å°±ä¼šéå¸¸ç¹ç</p><p><strong>SpringCloud Configæ˜¯ä»€ä¹ˆï¼Ÿ</strong></p><p>SpringCloud Configä¸ºå¾®æœåŠ¡æ¶æ„ä¸­çš„å¾®æœåŠ¡æä¾›é›†ä¸­åŒ–çš„å¤–éƒ¨é…ç½®æ”¯æŒï¼Œé…ç½®æœåŠ¡å™¨ä¸º<strong>å„ä¸ªä¸åŒå¾®æœåŠ¡åº”ç”¨</strong>çš„æ‰€æœ‰ç¯å¢ƒæä¾›äº†ä¸€ä¸ª<strong>ä¸­å¿ƒåŒ–çš„å¤–éƒ¨é…ç½®</strong>ã€‚</p><p>SpringCloud Configåˆ†ä¸º<strong>æœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯ä¸¤éƒ¨åˆ†</strong>ã€‚</p><figure><img src="https://xcy-fcblog-1304336794.cos.ap-nanjing.myqcloud.com/posts/SpringCloud/SpringCloud Config Server.png" alt="SpringCloud Config Server" tabindex="0" loading="lazy"><figcaption>SpringCloud Config Server</figcaption></figure><p>æœåŠ¡ç«¯ä¹Ÿç§°ä¸º<strong>åˆ†å¸ƒå¼é…ç½®ä¸­å¿ƒï¼Œå®ƒæ˜¯ä¸€ä¸ªç‹¬ç«‹çš„å¾®æœåŠ¡åº”ç”¨</strong>ï¼Œç”¨æ¥è¿æ¥é…ç½®æœåŠ¡å™¨å¹¶ä¸ºå®¢æˆ·ç«¯æä¾›è·å–é…ç½®ä¿¡æ¯ï¼ŒåŠ å¯†/è§£å¯†ä¿¡æ¯ç­‰è®¿é—®æ¥å£</p><p>å®¢æˆ·ç«¯åˆ™æ˜¯é€šè¿‡æŒ‡å®šçš„é…ç½®ä¸­å¿ƒæ¥ç®¡ç†åº”ç”¨èµ„æºï¼Œä»¥åŠä¸ä¸šåŠ¡ç›¸å…³çš„é…ç½®å†…å®¹ï¼Œå¹¶åœ¨å¯åŠ¨çš„æ—¶å€™ä»é…ç½®ä¸­å¿ƒè·å–å’ŒåŠ è½½é…ç½®ä¿¡æ¯é…ç½®æœåŠ¡å™¨é»˜è®¤é‡‡ç”¨gitæ¥å­˜å‚¨é…ç½®ä¿¡æ¯ï¼Œè¿™æ ·å°±æœ‰åŠ©äºå¯¹ç¯å¢ƒé…ç½®è¿›è¡Œç‰ˆæœ¬ç®¡ç†ï¼Œå¹¶ä¸”å¯ä»¥é€šè¿‡gitå®¢æˆ·ç«¯å·¥å…·æ¥æ–¹ä¾¿çš„ç®¡ç†å’Œè®¿é—®é…ç½®å†…å®¹ã€‚</p><p>SpringCloud Configçš„ä½œç”¨</p><ul><li>é›†ä¸­ç®¡ç†é…ç½®æ–‡ä»¶</li><li>ä¸åŒç¯å¢ƒä¸åŒé…ç½®ï¼ŒåŠ¨æ€åŒ–çš„é…ç½®æ›´æ–°ï¼Œåˆ†ç¯å¢ƒéƒ¨ç½²ï¼Œæ¯”å¦‚ï¼šdev/test/prod/beta/release</li><li>è¿è¡ŒæœŸé—´åŠ¨æ€è°ƒæ•´ï¼Œä¸å†éœ€è¦åœ¨æ¯ä¸ªæœåŠ¡éƒ¨ç½²çš„æœºå™¨ä¸Šç¼–å†™é…ç½®æ–‡ä»¶ï¼ŒæœåŠ¡ä¼šå‘é…ç½®ä¸­å¿ƒç»Ÿä¸€æ‹‰å»é…ç½®è‡ªå·±çš„ä¿¡æ¯</li><li>å½“é…ç½®å‘ç”Ÿå˜åŠ¨æ—¶ï¼ŒæœåŠ¡ä¸éœ€è¦é‡å¯å³å¯æ„ŸçŸ¥åˆ°é…ç½®çš„å˜åŒ–å¹¶åº”ç”¨åˆ°æ–°çš„é…ç½®</li><li>å°†é…ç½®ä¿¡æ¯ä»¥RESTæ¥å£çš„å½¢å¼æš´éœ²ï¼špostã€curlè®¿é—®åˆ·æ–°å‡å¯......</li></ul><p>ä¸githubæ•´åˆé…ç½®</p><p>ç”±äºSpringCloud Configé»˜è®¤ä½¿ç”¨Gitæ¥å­˜å‚¨é…ç½®æ–‡ä»¶(ä¹Ÿæœ‰å…¶å®ƒæ–¹å¼,æ¯”å¦‚æ”¯æŒSVNå’Œæœ¬åœ°æ–‡ä»¶)ï¼Œ ä½†æœ€æ¨èçš„è¿˜æ˜¯Gitï¼Œè€Œä¸”ä½¿ç”¨çš„æ˜¯http/httpsè®¿é—®çš„å½¢å¼</p><h3 id="_2ã€configæœåŠ¡ç«¯é…ç½®" tabindex="-1"><a class="header-anchor" href="#_2ã€configæœåŠ¡ç«¯é…ç½®" aria-hidden="true">#</a> 2ã€ConfigæœåŠ¡ç«¯é…ç½®</h3><p>åœ¨Springä¸­ymlé…ç½®æ–‡ä»¶é…ç½®ï¼š</p><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">server</span><span class="token punctuation">:</span>
  <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">3344</span>

<span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">application</span><span class="token punctuation">:</span>
    <span class="token key atrule">name</span><span class="token punctuation">:</span>  cloud<span class="token punctuation">-</span>config<span class="token punctuation">-</span>center <span class="token comment">#æ³¨å†Œè¿›EurekaæœåŠ¡å™¨çš„å¾®æœåŠ¡å</span>
  <span class="token key atrule">cloud</span><span class="token punctuation">:</span>
    <span class="token key atrule">config</span><span class="token punctuation">:</span>
      <span class="token key atrule">server</span><span class="token punctuation">:</span>
        <span class="token key atrule">git</span><span class="token punctuation">:</span>
          <span class="token key atrule">uri</span><span class="token punctuation">:</span> git@github.com<span class="token punctuation">:</span>zzyybs/springcloud<span class="token punctuation">-</span>config.git <span class="token comment">#GitHubä¸Šé¢çš„gitä»“åº“åå­—</span>
        <span class="token comment">####æœç´¢ç›®å½•</span>
          <span class="token key atrule">search-paths</span><span class="token punctuation">:</span>
            <span class="token punctuation">-</span> springcloud<span class="token punctuation">-</span>config
      <span class="token comment">####è¯»å–åˆ†æ”¯</span>
      <span class="token key atrule">label</span><span class="token punctuation">:</span> master

<span class="token comment">#æœåŠ¡æ³¨å†Œåˆ°eurekaåœ°å€</span>
<span class="token key atrule">eureka</span><span class="token punctuation">:</span>
  <span class="token key atrule">client</span><span class="token punctuation">:</span>
    <span class="token key atrule">service-url</span><span class="token punctuation">:</span>
      <span class="token key atrule">defaultZone</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//localhost<span class="token punctuation">:</span>7001/eureka
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é…ç½®è¯»å–è§„åˆ™åœ¨å®˜ç½‘ä¸Šæ˜¯è¿™ä¹ˆè¯´çš„</p><figure><img src="https://xcy-fcblog-1304336794.cos.ap-nanjing.myqcloud.com/posts/SpringCloud/SpringCloud Configé…ç½®è¯»å–è§„åˆ™.png" alt="SpringCloud Configé…ç½®è¯»å–è§„åˆ™" tabindex="0" loading="lazy"><figcaption>SpringCloud Configé…ç½®è¯»å–è§„åˆ™</figcaption></figure><p><mark>/{label}/{application}-{profile}.yml</mark></p><p>å…¶ä¸­ï¼šlabelï¼šåˆ†æ”¯(branch)ï¼›name ï¼šæœåŠ¡åï¼›profilesï¼šç¯å¢ƒ(dev/test/prod)</p><p>ç¤ºä¾‹å¦‚ä¸‹ï¼š</p><ul><li><p>masteråˆ†æ”¯</p><ul><li><a href="http://config-3344.com:3344/master/config-dev.yml" target="_blank" rel="noopener noreferrer">http://config-3344.com:3344/master/config-dev.yml<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="http://config-3344.com:3344/master/config-test.yml" target="_blank" rel="noopener noreferrer">http://config-3344.com:3344/master/config-test.yml<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="http://config-3344.com:3344/master/config-prod.yml" target="_blank" rel="noopener noreferrer">http://config-3344.com:3344/master/config-prod.yml<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li></ul></li><li><p>devåˆ†æ”¯ï¼š</p><ul><li><a href="http://config-3344.com:3344/dev/config-dev.yml" target="_blank" rel="noopener noreferrer">http://config-3344.com:3344/dev/config-dev.yml<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="http://config-3344.com:3344/dev/config-test.yml" target="_blank" rel="noopener noreferrer">http://config-3344.com:3344/dev/config-test.yml<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="http://config-3344.com:3344/dev/config-prod.yml" target="_blank" rel="noopener noreferrer">http://config-3344.com:3344/dev/config-prod.yml<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li></ul></li></ul><blockquote><p>é€†æ“ä½œï¼š<a href="http://config-3344.com:3344/config/dev/master" target="_blank" rel="noopener noreferrer">http://config-3344.com:3344/config/dev/master<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p>æ³¨æ„ï¼šå¦‚æœæ˜¯é€šè¿‡é€†æ“ä½œè¯»å–åˆ°çš„ï¼Œè¿”å›çš„ç»“æœå°†æ˜¯ä¸€ä¸²jsonæ ¼å¼çš„æ•°æ®ï¼Œéœ€è¦æˆ‘ä»¬è‡ªå·±æ“ä½œè¿›è¡Œè¯»å–æ•°æ®</p></blockquote><h3 id="_3ã€configå®¢æˆ·ç«¯é…ç½®" tabindex="-1"><a class="header-anchor" href="#_3ã€configå®¢æˆ·ç«¯é…ç½®" aria-hidden="true">#</a> 3ã€Configå®¢æˆ·ç«¯é…ç½®</h3><p>åœ¨å®¢æˆ·ç«¯éœ€è¦åŠ å…¥ä¸€ä¸ªæ–°çš„ymlæ–‡ä»¶ï¼Œ<mark>bootstrap.yml</mark></p><p><strong>bootstrap.ymlæ˜¯ä»€ä¹ˆï¼Ÿ</strong></p><p>applicaiton.ymlæ˜¯ç”¨æˆ·çº§çš„èµ„æºé…ç½®é¡¹ bootstrap.ymlæ˜¯ç³»ç»Ÿçº§çš„ï¼Œä¼˜å…ˆçº§æ›´åŠ é«˜</p><p>Spring Cloudä¼šåˆ›å»ºä¸€ä¸ªâ€œBootstrap Contextâ€ï¼Œä½œä¸ºSpringåº”ç”¨çš„<code>Application Context</code>çš„çˆ¶ä¸Šä¸‹æ–‡ã€‚åˆå§‹åŒ–çš„æ—¶å€™ï¼Œ<code>Bootstrap Context</code>è´Ÿè´£ä»å¤–éƒ¨æºåŠ è½½é…ç½®å±æ€§å¹¶è§£æé…ç½®ã€‚è¿™ä¸¤ä¸ªä¸Šä¸‹æ–‡å…±äº«ä¸€ä¸ªä»å¤–éƒ¨è·å–çš„<code>Environment</code>ã€‚</p><p><code>Bootstrap</code>å±æ€§æœ‰é«˜ä¼˜å…ˆçº§ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œå®ƒä»¬ä¸ä¼šè¢«æœ¬åœ°é…ç½®è¦†ç›–ã€‚ <code>Bootstrap context</code>å’Œ<code>Application Context</code>æœ‰ç€ä¸åŒçš„çº¦å®šï¼Œæ‰€ä»¥æ–°å¢äº†ä¸€ä¸ª<code>bootstrap.yml</code>æ–‡ä»¶ï¼Œä¿è¯<code>Bootstrap Context</code>å’Œ<code>Application Context</code>é…ç½®çš„åˆ†ç¦»ã€‚</p><p>è¦å°†Clientæ¨¡å—ä¸‹çš„application.ymlæ–‡ä»¶æ”¹ä¸ºbootstrap.yml,è¿™æ˜¯å¾ˆå…³é”®çš„ï¼Œ å› ä¸ºbootstrap.ymlæ˜¯æ¯”application.ymlå…ˆåŠ è½½çš„ã€‚bootstrap.ymlä¼˜å…ˆçº§é«˜äºapplication.yml</p><p>åœ¨bootstrap.ymlé…ç½®æ–‡ä»¶ä¸­åŠ å…¥</p><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">server</span><span class="token punctuation">:</span>
  <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">3355</span>

<span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">application</span><span class="token punctuation">:</span>
    <span class="token key atrule">name</span><span class="token punctuation">:</span> config<span class="token punctuation">-</span>client
  <span class="token key atrule">cloud</span><span class="token punctuation">:</span>
    <span class="token comment">#Configå®¢æˆ·ç«¯é…ç½®</span>
    <span class="token key atrule">config</span><span class="token punctuation">:</span>
      <span class="token key atrule">label</span><span class="token punctuation">:</span> master <span class="token comment">#åˆ†æ”¯åç§°</span>
      <span class="token key atrule">name</span><span class="token punctuation">:</span> config <span class="token comment">#é…ç½®æ–‡ä»¶åç§°</span>
      <span class="token key atrule">profile</span><span class="token punctuation">:</span> dev <span class="token comment">#è¯»å–åç¼€åç§°   ä¸Šè¿°3ä¸ªç»¼åˆï¼šmasteråˆ†æ”¯ä¸Šconfig-dev.ymlçš„é…ç½®æ–‡ä»¶è¢«è¯»å–http://config-3344.com:3344/master/config-dev.yml</span>
      <span class="token key atrule">uri</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//localhost<span class="token punctuation">:</span><span class="token number">3344</span> <span class="token comment">#é…ç½®ä¸­å¿ƒåœ°å€k</span>

<span class="token comment">#æœåŠ¡æ³¨å†Œåˆ°eurekaåœ°å€</span>
<span class="token key atrule">eureka</span><span class="token punctuation">:</span>
  <span class="token key atrule">client</span><span class="token punctuation">:</span>
    <span class="token key atrule">service-url</span><span class="token punctuation">:</span>
      <span class="token key atrule">defaultZone</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//localhost<span class="token punctuation">:</span>7001/eureka
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¯´æ˜ï¼š</p><figure><img src="https://xcy-fcblog-1304336794.cos.ap-nanjing.myqcloud.com/posts/SpringCloud/SpringCloud Configå®¢æˆ·ç«¯bootstrap.ymlè¯´æ˜.png" alt="SpringCloud Configå®¢æˆ·ç«¯bootstrap.ymlè¯´æ˜" tabindex="0" loading="lazy"><figcaption>SpringCloud Configå®¢æˆ·ç«¯bootstrap.ymlè¯´æ˜</figcaption></figure><p>ä½†æ˜¯è¿™ç§é…ç½®ä¾ç„¶æœ‰ä¸€ä¸ªç¼ºé™·ï¼Œå°±æ˜¯åˆ·æ–°é—®é¢˜ï¼Œå¦‚æœæœåŠ¡ç«¯æ›´æ–°äº†é…ç½®ï¼Œé‚£ä¹ˆæœåŠ¡å°±å¿…é¡»é‡å¯æ‰ä¼šç”Ÿæ•ˆï¼Œå¦‚æœæ˜¯å·²ç»éƒ¨ç½²ä¸Šçº¿çš„ç¨‹åºå‘¢ï¼Ÿè¿™å°±ä¼šå˜çš„å¾ˆéº»çƒ¦ã€‚</p><p><strong>åˆ†å¸ƒå¼é…ç½®çš„åŠ¨æ€åˆ·æ–°é—®é¢˜</strong></p><ul><li>Linuxè¿ç»´ä¿®æ”¹GitHubä¸Šçš„é…ç½®æ–‡ä»¶å†…å®¹åšè°ƒæ•´</li><li>åˆ·æ–°3344ï¼Œå‘ç°ConfigServeré…ç½®ä¸­å¿ƒç«‹åˆ»å“åº”</li><li>åˆ·æ–°3355ï¼Œå‘ç°ConfigClientå®¢æˆ·ç«¯æ²¡æœ‰ä»»ä½•å“åº”</li><li>3355æ²¡æœ‰å˜åŒ–é™¤éè‡ªå·±é‡å¯æˆ–è€…é‡æ–°åŠ è½½</li><li>éš¾åˆ°æ¯æ¬¡è¿ç»´ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼Œå®¢æˆ·ç«¯éƒ½éœ€è¦é‡å¯ï¼Ÿï¼Ÿå™©æ¢¦</li></ul><h3 id="_4ã€configå®¢æˆ·ç«¯åŠ¨æ€åˆ·æ–°" tabindex="-1"><a class="header-anchor" href="#_4ã€configå®¢æˆ·ç«¯åŠ¨æ€åˆ·æ–°" aria-hidden="true">#</a> 4ã€Configå®¢æˆ·ç«¯åŠ¨æ€åˆ·æ–°</h3><p>pomæ–‡ä»¶ä¸­åŠ å…¥actuatorç›‘æ§</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-actuator<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¿®æ”¹ymlæ–‡ä»¶ï¼Œæš´éœ²ç›‘æ§ç«¯å£</p><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">server</span><span class="token punctuation">:</span>
  <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">3355</span>

<span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">application</span><span class="token punctuation">:</span>
    <span class="token key atrule">name</span><span class="token punctuation">:</span> config<span class="token punctuation">-</span>client
  <span class="token key atrule">cloud</span><span class="token punctuation">:</span>
    <span class="token comment">#Configå®¢æˆ·ç«¯é…ç½®</span>
    <span class="token key atrule">config</span><span class="token punctuation">:</span>
      <span class="token key atrule">label</span><span class="token punctuation">:</span> master <span class="token comment">#åˆ†æ”¯åç§°</span>
      <span class="token key atrule">name</span><span class="token punctuation">:</span> config <span class="token comment">#é…ç½®æ–‡ä»¶åç§°</span>
      <span class="token key atrule">profile</span><span class="token punctuation">:</span> dev <span class="token comment">#è¯»å–åç¼€åç§°   ä¸Šè¿°3ä¸ªç»¼åˆï¼šmasteråˆ†æ”¯ä¸Šconfig-dev.ymlçš„é…ç½®æ–‡ä»¶è¢«è¯»å–</span>
      <span class="token key atrule">uri</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//localhost<span class="token punctuation">:</span><span class="token number">3344</span> <span class="token comment">#é…ç½®ä¸­å¿ƒåœ°å€k</span>

<span class="token comment">#æœåŠ¡æ³¨å†Œåˆ°eurekaåœ°å€</span>
<span class="token key atrule">eureka</span><span class="token punctuation">:</span>
  <span class="token key atrule">client</span><span class="token punctuation">:</span>
    <span class="token key atrule">service-url</span><span class="token punctuation">:</span>
      <span class="token key atrule">defaultZone</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//localhost<span class="token punctuation">:</span>7001/eureka
<span class="token comment"># æš´éœ²ç›‘æ§ç«¯ç‚¹</span>
<span class="token key atrule">management</span><span class="token punctuation">:</span>
  <span class="token key atrule">endpoints</span><span class="token punctuation">:</span>
    <span class="token key atrule">web</span><span class="token punctuation">:</span>
      <span class="token key atrule">exposure</span><span class="token punctuation">:</span>
        <span class="token key atrule">include</span><span class="token punctuation">:</span> <span class="token string">&quot;*&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨Controllerç±»ä¸ŠåŠ å…¥@RefreshScopeæ³¨è§£</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@RestController</span>
<span class="token annotation punctuation">@RefreshScope</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ConfigClientController</span><span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">&quot;${config.info}&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> configInfo<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/configInfo&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getConfigInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> configInfo<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ­¤æ—¶å°±å¯ä»¥å®ç°åŠ¨æ€åˆ·æ–°äº†ï¼Œä½†æ˜¯åˆ·æ–°æ˜¯æ‰‹åŠ¨ç‰ˆçš„åˆ·æ–°ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å¿…é¡»è¦ç»™å®¢æˆ·ç«¯æœåŠ¡å‘é€ä¸€ä¸ªpostè¯·æ±‚ï¼Œå‘ŠçŸ¥æœåŠ¡æˆ‘ä»¬çš„é…ç½®å·²ç»æ›´æ”¹äº†ï¼Œè®©æœåŠ¡å®Œæˆåˆ·æ–°ã€‚è¿™ç§æ‰‹åŠ¨ç‰ˆçš„å¯¹äºæœåŠ¡å™¨å°‘çš„å€’æ˜¯å¯ä»¥æ¥å—ï¼Œä½†æ˜¯å¦‚æœè¯´æ˜¯æˆ‘ä»¬çš„æœåŠ¡å™¨æ¯”è¾ƒå¤šï¼Œè€Œä¸”è¿˜æ˜¯å…·æœ‰é’ˆå¯¹æ€§çš„æœåŠ¡éœ€è¦åˆ·æ–°ï¼Œè¿™ç§æ—¶å€™å°±éš¾ä»¥é€‚ç”¨äº†ã€‚</p><h2 id="åã€springcloud-busæ¶ˆæ¯æ€»çº¿" tabindex="-1"><a class="header-anchor" href="#åã€springcloud-busæ¶ˆæ¯æ€»çº¿" aria-hidden="true">#</a> åã€SpringCloud Busæ¶ˆæ¯æ€»çº¿</h2><h3 id="_1ã€æ¦‚è¿°-2" tabindex="-1"><a class="header-anchor" href="#_1ã€æ¦‚è¿°-2" aria-hidden="true">#</a> 1ã€æ¦‚è¿°</h3><p>Buså¯ä»¥åˆ†å¸ƒå¼å®ç°è‡ªåŠ¨åˆ·æ–°é…ç½®åŠŸèƒ½ï¼Œä¹Ÿå°±æ˜¯SpringCloud Busé…åˆSpringCloud Configä½¿ç”¨å¯ä»¥å®ç°é…ç½®çš„åŠ¨æ€åˆ·æ–°ï¼ŒBuså¯ä»¥é€šè¿‡RabbitMQå’ŒKafkaä¸¤ç§æ¶ˆæ¯ä»£ç†å®ç°é…ç½®çš„åŠ¨æ€åˆ·æ–°ã€‚</p><p>é€šè¿‡æ¶ˆæ¯ä¸­é—´ä»¶å®ç°å…¨å±€é€šçŸ¥ï¼š</p><figure><img src="https://xcy-fcblog-1304336794.cos.ap-nanjing.myqcloud.com/posts/SpringCloud/SpringCloud Bus é…åˆSpringCloud Configä½¿ç”¨å¯ä»¥å®ç°é…ç½®çš„åŠ¨æ€åˆ·æ–°.png" alt="SpringCloud Busé…åˆSpringCloud Configä½¿ç”¨å¯ä»¥å®ç°é…ç½®çš„åŠ¨æ€åˆ·æ–°" tabindex="0" loading="lazy"><figcaption>SpringCloud Busé…åˆSpringCloud Configä½¿ç”¨å¯ä»¥å®ç°é…ç½®çš„åŠ¨æ€åˆ·æ–°</figcaption></figure><p>Spring Cloud Busæ˜¯ç”¨æ¥å°†åˆ†å¸ƒå¼ç³»ç»Ÿçš„èŠ‚ç‚¹ä¸è½»é‡çº§æ¶ˆæ¯ç³»ç»Ÿé“¾æ¥èµ·æ¥çš„æ¡†æ¶ï¼Œå®ƒæ•´åˆäº†Javaçš„äº‹ä»¶å¤„ç†æœºåˆ¶å’Œæ¶ˆæ¯ä¸­é—´ä»¶çš„åŠŸèƒ½ã€‚Spring Clud Busç›®å‰æ”¯æŒRabbitMQå’ŒKafkaã€‚</p><p>Spring Cloud Busèƒ½ç®¡ç†å’Œä¼ æ’­åˆ†å¸ƒå¼ç³»ç»Ÿé—´çš„æ¶ˆæ¯ï¼Œå°±åƒä¸€ä¸ªåˆ†å¸ƒå¼æ‰§è¡Œå™¨ï¼Œå¯ç”¨äºå¹¿æ’­çŠ¶æ€æ›´æ”¹ã€äº‹ä»¶æ¨é€ç­‰ï¼Œä¹Ÿå¯ä»¥å½“ä½œå¾®æœåŠ¡é—´çš„é€šä¿¡é€šé“ã€‚</p><figure><img src="https://xcy-fcblog-1304336794.cos.ap-nanjing.myqcloud.com/posts/SpringCloud/SpringCloud Busç®¡ç†å’Œä¼ æ’­åˆ†å¸ƒå¼ç³»ç»Ÿé—´çš„æ¶ˆæ¯.png" alt="SpringCloud Busç®¡ç†å’Œä¼ æ’­åˆ†å¸ƒå¼ç³»ç»Ÿé—´çš„æ¶ˆæ¯" tabindex="0" loading="lazy"><figcaption>SpringCloud Busç®¡ç†å’Œä¼ æ’­åˆ†å¸ƒå¼ç³»ç»Ÿé—´çš„æ¶ˆæ¯</figcaption></figure><p><strong>ä»€ä¹ˆæ˜¯æ€»çº¿ï¼Ÿ</strong> åœ¨å¾®æœåŠ¡æ¶æ„çš„ç³»ç»Ÿä¸­ï¼Œé€šå¸¸ä¼šä½¿ç”¨è½»é‡çº§çš„æ¶ˆæ¯ä»£ç†æ¥æ„å»ºä¸€ä¸ªå…±ç”¨çš„æ¶ˆæ¯ä¸»é¢˜ï¼Œå¹¶è®©ç³»ç»Ÿä¸­æ‰€æœ‰å¾®æœåŠ¡å®ä¾‹éƒ½è¿æ¥ä¸Šæ¥ã€‚ç”±äºè¯¥ä¸»é¢˜ä¸­äº§ç”Ÿçš„æ¶ˆæ¯ä¼šè¢«æ‰€æœ‰å®ä¾‹ç›‘å¬å’Œæ¶ˆè´¹ï¼Œæ‰€ä»¥ç§°å®ƒä¸ºæ¶ˆæ¯æ€»çº¿ã€‚åœ¨æ€»çº¿ä¸Šçš„å„ä¸ªå®ä¾‹ï¼Œéƒ½å¯ä»¥æ–¹ä¾¿åœ°å¹¿æ’­ä¸€äº›éœ€è¦è®©å…¶ä»–è¿æ¥åœ¨è¯¥ä¸»é¢˜ä¸Šçš„å®ä¾‹éƒ½çŸ¥é“çš„æ¶ˆæ¯ã€‚</p><p><strong>åŸºæœ¬åŸç†ï¼Ÿ</strong> ConfigClientå®ä¾‹éƒ½ç›‘å¬MQä¸­åŒä¸€ä¸ªtopic(é»˜è®¤æ˜¯springCloudBus)ã€‚å½“ä¸€ä¸ªæœåŠ¡åˆ·æ–°æ•°æ®çš„æ—¶å€™ï¼Œå®ƒä¼šæŠŠè¿™ä¸ªä¿¡æ¯æ”¾å…¥åˆ°Topicä¸­ï¼Œè¿™æ ·å…¶å®ƒç›‘å¬åŒä¸€Topicçš„æœåŠ¡å°±èƒ½å¾—åˆ°é€šçŸ¥ï¼Œç„¶åå»æ›´æ–°è‡ªèº«çš„é…ç½®ã€‚</p><h3 id="_2ã€busä¹‹rabbitmqç¯å¢ƒé…ç½®" tabindex="-1"><a class="header-anchor" href="#_2ã€busä¹‹rabbitmqç¯å¢ƒé…ç½®" aria-hidden="true">#</a> 2ã€Busä¹‹RabbitMQç¯å¢ƒé…ç½®</h3><p>å®‰è£…Erlangï¼Œä¸‹è½½åœ°å€ï¼š<a href="http://erlang.org/download/otp_win64_21.3.exe" target="_blank" rel="noopener noreferrer">http://erlang.org/download/otp_win64_21.3.exe<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p>å®‰è£…RabbitMQï¼Œä¸‹è½½åœ°å€ï¼š<a href="https://dl.bintray.com/rabbitmq/all/rabbitmq-server/3.7.14/rabbitmq-server-3.7.14.exe" target="_blank" rel="noopener noreferrer">https://dl.bintray.com/rabbitmq/all/rabbitmq-server/3.7.14/rabbitmq-server-3.7.14.exe<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p>RabbitMQè£…æœ‰å¯è§†åŒ–æ’ä»¶ï¼Œè¿›å…¥RabbitMQå®‰è£…ç›®å½•ä¸‹çš„sbinç›®å½•ï¼Œè¾“å…¥ä»¥ä¸‹å‘½ä»¤å¯åŠ¨ç®¡ç†åŠŸèƒ½ï¼š</p><p>rabbitmq-plugins enable rabbitmq_management</p><p>å‘½ä»¤æ‰§è¡Œå®Œåï¼Œå¯ä»¥åœ¨å¼€å§‹èœå•ä¸­æ‰¾åˆ°RabbitMQ Server ä¸‹æ‰¾åˆ°å¯è§†åŒ–æ’ä»¶ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡<a href="http://localhost:15672/%E6%9F%A5%E7%9C%8BRabbitMQ%E6%98%AF%E5%90%A6%E5%AE%89%E8%A3%85%E6%88%90%E5%8A%9F%EF%BC%8C%E8%BF%9B%E5%85%A5%E5%90%8E%E7%99%BB%E5%BD%95%E9%A1%B5%E9%9D%A2%E5%A6%82%E4%B8%8B%E3%80%82" target="_blank" rel="noopener noreferrer">http://localhost:15672/æŸ¥çœ‹RabbitMQæ˜¯å¦å®‰è£…æˆåŠŸï¼Œè¿›å…¥åç™»å½•é¡µé¢å¦‚ä¸‹ã€‚<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><figure><img src="https://xcy-fcblog-1304336794.cos.ap-nanjing.myqcloud.com/posts/SpringCloud/RabbitMQç™»å½•.png" alt="RabbitMQç™»å½•" tabindex="0" loading="lazy"><figcaption>RabbitMQç™»å½•</figcaption></figure><p>ä¹‹åè¾“å…¥è´¦å·å¯†ç ï¼Œguestï¼Œguestï¼Œå°±å¯ä»¥ç™»å½•æˆåŠŸã€‚</p><h3 id="_3ã€springcloud-busåŠ¨æ€åˆ·æ–°å…¨å±€å¹¿æ’­" tabindex="-1"><a class="header-anchor" href="#_3ã€springcloud-busåŠ¨æ€åˆ·æ–°å…¨å±€å¹¿æ’­" aria-hidden="true">#</a> 3ã€SpringCloud BusåŠ¨æ€åˆ·æ–°å…¨å±€å¹¿æ’­</h3><p>å¯åŠ¨å¥½RabbitMQç¯å¢ƒ</p><p><strong>è®¾è®¡æ€æƒ³ï¼š</strong></p><ul><li>åˆ©ç”¨æ¶ˆæ¯æ€»çº¿è§¦å‘ä¸€ä¸ªå®¢æˆ·ç«¯/bus/refresh,è€Œåˆ·æ–°æ‰€æœ‰å®¢æˆ·ç«¯çš„é…ç½®</li></ul><figure><img src="https://xcy-fcblog-1304336794.cos.ap-nanjing.myqcloud.com/posts/SpringCloud/image-20230606212012633.png" alt="æ¶ˆæ¯æ€»çº¿è§¦å‘ä¸€ä¸ªå®¢æˆ·ç«¯å›¾ä¸€" tabindex="0" loading="lazy"><figcaption>æ¶ˆæ¯æ€»çº¿è§¦å‘ä¸€ä¸ªå®¢æˆ·ç«¯å›¾ä¸€</figcaption></figure><ul><li>åˆ©ç”¨æ¶ˆæ¯æ€»çº¿è§¦å‘ä¸€ä¸ªæœåŠ¡ç«¯ConfigServerçš„/bus/refreshç«¯ç‚¹ï¼Œè€Œåˆ·æ–°æ‰€æœ‰å®¢æˆ·ç«¯çš„é…ç½®</li></ul><figure><img src="https://xcy-fcblog-1304336794.cos.ap-nanjing.myqcloud.com/posts/SpringCloud/image-20230606212501053.png" alt="æ¶ˆæ¯æ€»çº¿è§¦å‘ä¸€ä¸ªå®¢æˆ·ç«¯å›¾äºŒ" tabindex="0" loading="lazy"><figcaption>æ¶ˆæ¯æ€»çº¿è§¦å‘ä¸€ä¸ªå®¢æˆ·ç«¯å›¾äºŒ</figcaption></figure><p>å›¾äºŒçš„æ¶æ„æ˜¾ç„¶æ›´åŠ é€‚åˆï¼Œå›¾ä¸€ä¸é€‚åˆçš„åŸå› å¦‚ä¸‹</p><ul><li>æ‰“ç ´äº†å¾®æœåŠ¡çš„èŒè´£å•ä¸€æ€§ï¼Œå› ä¸ºå¾®æœåŠ¡æœ¬èº«æ˜¯ä¸šåŠ¡æ¨¡å—ï¼Œå®ƒæœ¬ä¸åº”è¯¥æ‰¿æ‹…é…ç½®åˆ·æ–°çš„èŒè´£ã€‚</li><li>ç ´åäº†å¾®æœåŠ¡å„èŠ‚ç‚¹çš„å¯¹ç­‰æ€§ã€‚</li><li>æœ‰ä¸€å®šçš„å±€é™æ€§ã€‚ä¾‹å¦‚ï¼Œå¾®æœåŠ¡åœ¨è¿ç§»æ—¶ï¼Œå®ƒçš„ç½‘ç»œåœ°å€å¸¸å¸¸ä¼šå‘ç”Ÿå˜åŒ–ï¼Œæ­¤æ—¶å¦‚æœæƒ³è¦åšåˆ°è‡ªåŠ¨åˆ·æ–°ï¼Œé‚£å°±ä¼šå¢åŠ æ›´å¤šçš„ä¿®æ”¹</li></ul><p><strong>ç»™é…ç½®ä¸­å¿ƒ<mark>æœåŠ¡ç«¯</mark>æ·»åŠ æ¶ˆæ¯æ€»çº¿æ”¯æŒ</strong></p><p>åŠ å…¥mavenä¾èµ–</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token comment">&lt;!--æ·»åŠ æ¶ˆæ¯æ€»çº¿RabbitMQæ”¯æŒ--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-cloud-starter-bus-amqp<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å‡å¦‚ymlé…ç½®æ–‡ä»¶</p><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">server</span><span class="token punctuation">:</span>
  <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">3344</span>

<span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">application</span><span class="token punctuation">:</span>
    <span class="token key atrule">name</span><span class="token punctuation">:</span>  cloud<span class="token punctuation">-</span>config<span class="token punctuation">-</span>center <span class="token comment">#æ³¨å†Œè¿›EurekaæœåŠ¡å™¨çš„å¾®æœåŠ¡å</span>
  <span class="token key atrule">cloud</span><span class="token punctuation">:</span>
    <span class="token key atrule">config</span><span class="token punctuation">:</span>
      <span class="token key atrule">server</span><span class="token punctuation">:</span>
        <span class="token key atrule">git</span><span class="token punctuation">:</span>
          <span class="token key atrule">uri</span><span class="token punctuation">:</span> git@github.com<span class="token punctuation">:</span>zzyybs/springcloud<span class="token punctuation">-</span>config.git <span class="token comment">#GitHubä¸Šé¢çš„gitä»“åº“åå­—</span>
        <span class="token comment">####æœç´¢ç›®å½•</span>
          <span class="token key atrule">search-paths</span><span class="token punctuation">:</span>
            <span class="token punctuation">-</span> springcloud<span class="token punctuation">-</span>config
      <span class="token comment">####è¯»å–åˆ†æ”¯</span>
      <span class="token key atrule">label</span><span class="token punctuation">:</span> master
<span class="token comment">#rabbitmqç›¸å…³é…ç½®</span>
<span class="token key atrule">rabbitmq</span><span class="token punctuation">:</span>
    <span class="token key atrule">host</span><span class="token punctuation">:</span> localhost
    <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">5672</span>
    <span class="token key atrule">username</span><span class="token punctuation">:</span> guest
    <span class="token key atrule">password</span><span class="token punctuation">:</span> guest

<span class="token comment">#æœåŠ¡æ³¨å†Œåˆ°eurekaåœ°å€</span>
<span class="token key atrule">eureka</span><span class="token punctuation">:</span>
  <span class="token key atrule">client</span><span class="token punctuation">:</span>
    <span class="token key atrule">service-url</span><span class="token punctuation">:</span>
      <span class="token key atrule">defaultZone</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//localhost<span class="token punctuation">:</span>7001/eureka

<span class="token comment">##rabbitmqç›¸å…³é…ç½®,æš´éœ²busåˆ·æ–°é…ç½®çš„ç«¯ç‚¹</span>
<span class="token key atrule">management</span><span class="token punctuation">:</span>
  <span class="token key atrule">endpoints</span><span class="token punctuation">:</span> <span class="token comment">#æš´éœ²busåˆ·æ–°é…ç½®çš„ç«¯ç‚¹</span>
    <span class="token key atrule">web</span><span class="token punctuation">:</span>
      <span class="token key atrule">exposure</span><span class="token punctuation">:</span>
        <span class="token key atrule">include</span><span class="token punctuation">:</span> <span class="token string">&#39;bus-refresh&#39;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>ç»™<mark>å®¢æˆ·ç«¯</mark>æ·»åŠ æ¶ˆæ¯æ€»çº¿æ”¯æŒ</strong></p><p>åŠ å…¥mavenä¾èµ–</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token comment">&lt;!--æ·»åŠ æ¶ˆæ¯æ€»çº¿RabbitMQæ”¯æŒ--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-cloud-starter-bus-amqp<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¿®æ”¹ymlæ–‡ä»¶</p><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">server</span><span class="token punctuation">:</span>
  <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">3355</span>

<span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">application</span><span class="token punctuation">:</span>
    <span class="token key atrule">name</span><span class="token punctuation">:</span> config<span class="token punctuation">-</span>client
  <span class="token key atrule">cloud</span><span class="token punctuation">:</span>
    <span class="token comment">#Configå®¢æˆ·ç«¯é…ç½®</span>
    <span class="token key atrule">config</span><span class="token punctuation">:</span>
      <span class="token key atrule">label</span><span class="token punctuation">:</span> master <span class="token comment">#åˆ†æ”¯åç§°</span>
      <span class="token key atrule">name</span><span class="token punctuation">:</span> config <span class="token comment">#é…ç½®æ–‡ä»¶åç§°</span>
      <span class="token key atrule">profile</span><span class="token punctuation">:</span> dev <span class="token comment">#è¯»å–åç¼€åç§°   ä¸Šè¿°3ä¸ªç»¼åˆï¼šmasteråˆ†æ”¯ä¸Šconfig-dev.ymlçš„é…ç½®æ–‡ä»¶è¢«è¯»å–</span>
      <span class="token key atrule">uri</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//localhost<span class="token punctuation">:</span><span class="token number">3344</span> <span class="token comment">#é…ç½®ä¸­å¿ƒåœ°å€k</span>
<span class="token comment">#rabbitmqç›¸å…³é…ç½® 15672æ˜¯Webç®¡ç†ç•Œé¢çš„ç«¯å£ï¼›5672æ˜¯MQè®¿é—®çš„ç«¯å£</span>
  <span class="token key atrule">rabbitmq</span><span class="token punctuation">:</span>
    <span class="token key atrule">host</span><span class="token punctuation">:</span> localhost
    <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">5672</span>
    <span class="token key atrule">username</span><span class="token punctuation">:</span> guest
    <span class="token key atrule">password</span><span class="token punctuation">:</span> guest

<span class="token comment">#æœåŠ¡æ³¨å†Œåˆ°eurekaåœ°å€</span>
<span class="token key atrule">eureka</span><span class="token punctuation">:</span>
  <span class="token key atrule">client</span><span class="token punctuation">:</span>
    <span class="token key atrule">service-url</span><span class="token punctuation">:</span>
      <span class="token key atrule">defaultZone</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//localhost<span class="token punctuation">:</span>7001/eureka
<span class="token comment"># æš´éœ²ç›‘æ§ç«¯ç‚¹</span>
<span class="token key atrule">management</span><span class="token punctuation">:</span>
  <span class="token key atrule">endpoints</span><span class="token punctuation">:</span>
    <span class="token key atrule">web</span><span class="token punctuation">:</span>
      <span class="token key atrule">exposure</span><span class="token punctuation">:</span>
        <span class="token key atrule">include</span><span class="token punctuation">:</span> <span class="token string">&quot;*&quot;</span>   <span class="token comment"># &#39;refresh&#39;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>ç»™<mark>å¦ä¸€å°å®¢æˆ·ç«¯</mark>æ·»åŠ æ¶ˆæ¯æ€»çº¿æ”¯æŒ</strong></p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token comment">&lt;!--æ·»åŠ æ¶ˆæ¯æ€»çº¿RabbitMQæ”¯æŒ--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-cloud-starter-bus-amqp<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¿®æ”¹ymlæ–‡ä»¶</p><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">server</span><span class="token punctuation">:</span>
  <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">3366</span>

<span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">application</span><span class="token punctuation">:</span>
    <span class="token key atrule">name</span><span class="token punctuation">:</span> config<span class="token punctuation">-</span>client
  <span class="token key atrule">cloud</span><span class="token punctuation">:</span>
    <span class="token comment">#Configå®¢æˆ·ç«¯é…ç½®</span>
    <span class="token key atrule">config</span><span class="token punctuation">:</span>
      <span class="token key atrule">label</span><span class="token punctuation">:</span> master <span class="token comment">#åˆ†æ”¯åç§°</span>
      <span class="token key atrule">name</span><span class="token punctuation">:</span> config <span class="token comment">#é…ç½®æ–‡ä»¶åç§°</span>
      <span class="token key atrule">profile</span><span class="token punctuation">:</span> dev <span class="token comment">#è¯»å–åç¼€åç§°   ä¸Šè¿°3ä¸ªç»¼åˆï¼šmasteråˆ†æ”¯ä¸Šconfig-dev.ymlçš„é…ç½®æ–‡ä»¶è¢«è¯»å–</span>
      <span class="token key atrule">uri</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//localhost<span class="token punctuation">:</span><span class="token number">3344</span> <span class="token comment">#é…ç½®ä¸­å¿ƒåœ°å€k</span>
<span class="token comment">#rabbitmqç›¸å…³é…ç½® 15672æ˜¯Webç®¡ç†ç•Œé¢çš„ç«¯å£ï¼›5672æ˜¯MQè®¿é—®çš„ç«¯å£</span>
  <span class="token key atrule">rabbitmq</span><span class="token punctuation">:</span>
    <span class="token key atrule">host</span><span class="token punctuation">:</span> localhost
    <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">5672</span>
    <span class="token key atrule">username</span><span class="token punctuation">:</span> guest
    <span class="token key atrule">password</span><span class="token punctuation">:</span> guest

<span class="token comment">#æœåŠ¡æ³¨å†Œåˆ°eurekaåœ°å€</span>
<span class="token key atrule">eureka</span><span class="token punctuation">:</span>
  <span class="token key atrule">client</span><span class="token punctuation">:</span>
    <span class="token key atrule">service-url</span><span class="token punctuation">:</span>
      <span class="token key atrule">defaultZone</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//localhost<span class="token punctuation">:</span>7001/eureka
<span class="token comment"># æš´éœ²ç›‘æ§ç«¯ç‚¹</span>
<span class="token key atrule">management</span><span class="token punctuation">:</span>
  <span class="token key atrule">endpoints</span><span class="token punctuation">:</span>
    <span class="token key atrule">web</span><span class="token punctuation">:</span>
      <span class="token key atrule">exposure</span><span class="token punctuation">:</span>
        <span class="token key atrule">include</span><span class="token punctuation">:</span> <span class="token string">&quot;*&quot;</span>   <span class="token comment"># &#39;refresh&#39;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿ç»´å·¥ç¨‹å¸ˆå¯ä»¥åœ¨è¿œç¨‹é…ç½®æ–‡ä»¶ä¸­è¿›è¡Œä¿®æ”¹ï¼Œç„¶åå‘é€ç»™æœåŠ¡å™¨ä¸€ä¸ªpostè¯·æ±‚ï¼Œé…ç½®ä¸­å¿ƒå’Œå®¢æˆ·ç«¯éƒ½ä¼šå®Œæˆåˆ·æ–°</p><h3 id="_4ã€springcloud-busåŠ¨æ€åˆ·æ–°å®šç‚¹é€šçŸ¥" tabindex="-1"><a class="header-anchor" href="#_4ã€springcloud-busåŠ¨æ€åˆ·æ–°å®šç‚¹é€šçŸ¥" aria-hidden="true">#</a> 4ã€SpringCloud BusåŠ¨æ€åˆ·æ–°å®šç‚¹é€šçŸ¥</h3><p>æœ‰æ—¶å€™æˆ‘ä»¬åœ¨è¿›è¡Œä¿®æ”¹äº†ä¸€äº›é…ç½®åï¼Œåªæƒ³è¦ä¸ªåˆ«çš„å®ä¾‹ç”Ÿæ•ˆï¼Œè€Œä¸æ˜¯é’ˆå¯¹å…¨éƒ¨ç”Ÿæ•ˆï¼Œè¿™æ—¶å€™å°±éœ€è¦ç”¨åˆ°å®šç‚¹é€šçŸ¥äº†ã€‚</p><p>æˆ‘ä»¬ä¸ªå¯ä»¥é€šè¿‡ä¸€ä¸ªå…¬å¼æ¥å®Œæˆå®šç‚¹åˆ·æ–°ï¼š</p><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>h</mi><mi>t</mi><mi>t</mi><mi>p</mi><mo>:</mo><mi mathvariant="normal">/</mi><mi mathvariant="normal">/</mi><mi>l</mi><mi>o</mi><mi>c</mi><mi>a</mi><mi>l</mi><mi>h</mi><mi>o</mi><mi>s</mi><mi>t</mi><mo>:</mo><mtext>é…ç½®ä¸­å¿ƒçš„ç«¯å£å·</mtext><mi mathvariant="normal">/</mi><mi>a</mi><mi>c</mi><mi>t</mi><mi>u</mi><mi>a</mi><mi>t</mi><mi>o</mi><mi>r</mi><mi mathvariant="normal">/</mi><mi>b</mi><mi>u</mi><mi>s</mi><mo>âˆ’</mo><mi>r</mi><mi>e</mi><mi>f</mi><mi>r</mi><mi>e</mi><mi>s</mi><mi>h</mi><mi mathvariant="normal">/</mi><mrow><mi>d</mi><mi>e</mi><mi>s</mi><mi>t</mi><mi>i</mi><mi>n</mi><mi>a</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi>n</mi></mrow></mrow><annotation encoding="application/x-tex"> http://localhost:é…ç½®ä¸­å¿ƒçš„ç«¯å£å·/actuator/bus-refresh/{destination} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">h</span><span class="mord mathnormal">ttp</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">//</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">oc</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">h</span><span class="mord mathnormal">os</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord cjk_fallback">é…ç½®ä¸­å¿ƒçš„ç«¯å£å·</span><span class="mord">/</span><span class="mord mathnormal">a</span><span class="mord mathnormal">c</span><span class="mord mathnormal">t</span><span class="mord mathnormal">u</span><span class="mord mathnormal">a</span><span class="mord mathnormal">t</span><span class="mord mathnormal" style="margin-right:0.02778em;">or</span><span class="mord">/</span><span class="mord mathnormal">b</span><span class="mord mathnormal">u</span><span class="mord mathnormal">s</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">re</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal">res</span><span class="mord mathnormal">h</span><span class="mord">/</span><span class="mord"><span class="mord mathnormal">d</span><span class="mord mathnormal">es</span><span class="mord mathnormal">t</span><span class="mord mathnormal">ina</span><span class="mord mathnormal">t</span><span class="mord mathnormal">i</span><span class="mord mathnormal">o</span><span class="mord mathnormal">n</span></span></span></span></span></span></p><p>è¿™æ ·/bus/refreshè¯·æ±‚å°±ä¸å†å‘é€åˆ°å…·ä½“çš„æœåŠ¡å®ä¾‹ä¸Šï¼Œè€Œæ˜¯å‘ç»™config serverå¹¶é€šè¿‡destinationå‚æ•°ç±»æŒ‡å®šéœ€è¦æ›´æ–°é…ç½®çš„æœåŠ¡æˆ–å®ä¾‹äº†</p><figure><img src="https://xcy-fcblog-1304336794.cos.ap-nanjing.myqcloud.com/posts/SpringCloud/image-20230606214342782.png" alt="Busé€šçŸ¥æ€»ç»“" tabindex="0" loading="lazy"><figcaption>Busé€šçŸ¥æ€»ç»“</figcaption></figure><h2 id="åä¸€ã€springcloud-streamæ¶ˆæ¯é©±åŠ¨" tabindex="-1"><a class="header-anchor" href="#åä¸€ã€springcloud-streamæ¶ˆæ¯é©±åŠ¨" aria-hidden="true">#</a> åä¸€ã€SpringCloud Streamæ¶ˆæ¯é©±åŠ¨</h2><p>åœ¨å®é™…å¼€å‘ä¹‹ä¸­ï¼Œæˆ‘ä»¬ä¼šéœ€è¦å¾ˆå¤šçš„æ¶ˆæ¯ä¸­é—´ä»¶ï¼Œæ¯”å¦‚è¯´ActiveMQã€RabbitMQã€RocketMQã€Kafkaç­‰ã€‚ä½†æ˜¯æˆ‘ä»¬å­¦ä¼šäº†ä¸€ç§MQï¼Œåˆ°äº†å…¬å¸å‘ç°ç”¨çš„æ˜¯å…¶ä»–çš„MQï¼Œè¿™æ— ç–‘æ˜¯ç»™å¼€å‘äººå‘˜å¢åŠ äº†å­¦ä¹ æˆæœ¬ã€‚å› æ­¤æˆ‘ä»¬éœ€è¦ä¸€ç§æ–°çš„æŠ€æœ¯ï¼Œè®©å¼€å‘äººå‘˜ä¸å†å…³æ³¨å…·ä½“çš„MQç»†èŠ‚ï¼Œæˆ‘ä»¬åªéœ€è¦ä½¿ç”¨ä¸€ç§é€‚é…ç»‘å®šçš„æ–¹å¼ï¼Œè‡ªåŠ¨ç»™æˆ‘ä»¬åœ¨å„ç§MQå†…åˆ‡æ¢ã€‚</p><h3 id="_1ã€æ¦‚è¿°-3" tabindex="-1"><a class="header-anchor" href="#_1ã€æ¦‚è¿°-3" aria-hidden="true">#</a> 1ã€æ¦‚è¿°</h3><p><strong>SpringCloud Streamå¯ä»¥å±è”½åº•å±‚æ¶ˆæ¯ä¸­é—´ä»¶çš„å·®å¼‚ï¼Œé™ä½åˆ‡æ¢æˆæœ¬ï¼Œç»Ÿä¸€æ¶ˆæ¯çš„ç¼–ç¨‹æ¨¡å‹</strong></p><p>å®˜æ–¹å®šä¹‰ Spring Cloud Stream æ˜¯ä¸€ä¸ªæ„å»ºæ¶ˆæ¯é©±åŠ¨å¾®æœåŠ¡çš„æ¡†æ¶ã€‚</p><p>åº”ç”¨ç¨‹åºé€šè¿‡ inputs æˆ–è€… outputs æ¥ä¸ Spring Cloud Streamä¸­binderå¯¹è±¡äº¤äº’ã€‚ é€šè¿‡æˆ‘ä»¬é…ç½®æ¥binding(ç»‘å®š) ï¼Œè€Œ Spring Cloud Stream çš„ binderå¯¹è±¡è´Ÿè´£ä¸æ¶ˆæ¯ä¸­é—´ä»¶äº¤äº’ã€‚ æ‰€ä»¥ï¼Œæˆ‘ä»¬åªéœ€è¦ææ¸…æ¥šå¦‚ä½•ä¸ Spring Cloud Stream äº¤äº’å°±å¯ä»¥æ–¹ä¾¿ä½¿ç”¨æ¶ˆæ¯é©±åŠ¨çš„æ–¹å¼ã€‚</p><p>é€šè¿‡ä½¿ç”¨Spring Integrationæ¥è¿æ¥æ¶ˆæ¯ä»£ç†ä¸­é—´ä»¶ä»¥å®ç°æ¶ˆæ¯äº‹ä»¶é©±åŠ¨ã€‚ Spring Cloud Stream ä¸ºä¸€äº›ä¾›åº”å•†çš„æ¶ˆæ¯ä¸­é—´ä»¶äº§å“æä¾›äº†ä¸ªæ€§åŒ–çš„è‡ªåŠ¨åŒ–é…ç½®å®ç°ï¼Œå¼•ç”¨äº†å‘å¸ƒ-è®¢é˜…ã€æ¶ˆè´¹ç»„ã€åˆ†åŒºçš„ä¸‰ä¸ªæ ¸å¿ƒæ¦‚å¿µã€‚</p><p>ç›®å‰ä»…æ”¯æŒRabbitMQã€Kafkaã€‚</p><p>å®˜ç½‘ï¼š</p><ul><li><a href="https://spring.io/projects/spring-cloud-stream#overview" target="_blank" rel="noopener noreferrer">https://spring.io/projects/spring-cloud-stream#overview<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://cloud.spring.io/spring-cloud-static/spring-cloud-stream/3.0.1.RELEASE/reference/html/" target="_blank" rel="noopener noreferrer">https://cloud.spring.io/spring-cloud-static/spring-cloud-stream/3.0.1.RELEASE/reference/html/<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li>Spring Cloud Streamä¸­æ–‡æŒ‡å¯¼æ‰‹å†Œï¼š<a href="https://m.wang1314.com/doc/wepapp/topic/20971999.html" target="_blank" rel="noopener noreferrer">https://m.wang1314.com/doc/wepapp/topic/20971999.html<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li></ul><p>Spring Cloud Streamæ˜¯ç”¨äºæ„å»ºä¸å…±äº«æ¶ˆæ¯ä¼ é€’ç³»ç»Ÿè¿æ¥çš„é«˜åº¦å¯ä¼¸ç¼©çš„äº‹ä»¶é©±åŠ¨å¾®æœåŠ¡æ¡†æ¶ï¼Œè¯¥æ¡†æ¶æä¾›äº†ä¸€ä¸ªçµæ´»çš„ç¼–ç¨‹æ¨¡å‹ï¼Œå®ƒå»ºç«‹åœ¨å·²ç»å»ºç«‹å’Œç†Ÿæ‚‰çš„Springç†Ÿè¯­å’Œæœ€ä½³å®è·µä¸Šï¼ŒåŒ…æ‹¬æ”¯æŒæŒä¹…åŒ–çš„å‘å¸ƒ/è®¢é˜…ã€æ¶ˆè´¹ç»„ä»¥åŠæ¶ˆæ¯åˆ†åŒºè¿™ä¸‰ä¸ªæ ¸å¿ƒæ¦‚å¿µ</p><figure><img src="https://xcy-fcblog-1304336794.cos.ap-nanjing.myqcloud.com/posts/SpringCloud/image-20230617110619720.png" alt="image-20230617110619720" tabindex="0" loading="lazy"><figcaption>image-20230617110619720</figcaption></figure><p><strong>è®¾è®¡æ€æƒ³ï¼š</strong></p><figure><img src="https://xcy-fcblog-1304336794.cos.ap-nanjing.myqcloud.com/posts/SpringCloud/image-20230617105101555.png" alt="image-20230617105101555" tabindex="0" loading="lazy"><figcaption>image-20230617105101555</figcaption></figure><ul><li>æ ‡å‡†MQ <ul><li>ç”Ÿäº§è€…/æ¶ˆè´¹è€…ä¹‹é—´é æ¶ˆæ¯åª’ä»‹ä¼ é€’ä¿¡æ¯å†…å®¹ï¼šMessage</li><li>æ¶ˆæ¯å¿…é¡»èµ°ç‰¹å®šçš„é€šé“ï¼šæ¶ˆæ¯é€šé“MessageChannel</li><li>æ¶ˆæ¯é€šé“é‡Œçš„æ¶ˆæ¯å¦‚ä½•è¢«æ¶ˆè´¹å‘¢ï¼Œè°è´Ÿè´£æ”¶å‘å¤„ç†ï¼šæ¶ˆæ¯é€šé“MessageChannelçš„å­æ¥å£SubscribableChannelï¼Œç”±MessageHandleræ¶ˆæ¯å¤„ç†å™¨æ‰€è®¢é˜…</li></ul></li></ul><p><strong>ä½¿ç”¨Cloud StreamåŸå› ï¼š</strong></p><figure><img src="https://xcy-fcblog-1304336794.cos.ap-nanjing.myqcloud.com/posts/SpringCloud/æ— æ ‡é¢˜.png" alt="æ— æ ‡é¢˜" tabindex="0" loading="lazy"><figcaption>æ— æ ‡é¢˜</figcaption></figure><p>æ¯”æ–¹è¯´æˆ‘ä»¬ç”¨åˆ°äº†RabbitMQå’ŒKafkaï¼Œç”±äºè¿™ä¸¤ä¸ªæ¶ˆæ¯ä¸­é—´ä»¶çš„æ¶æ„ä¸Šçš„ä¸åŒï¼ŒåƒRabbitMQæœ‰exchangeï¼Œkafkaæœ‰Topicå’ŒPartitionsåˆ†åŒºï¼Œè¿™äº›ä¸­é—´ä»¶çš„å·®å¼‚æ€§å¯¼è‡´æˆ‘ä»¬å®é™…é¡¹ç›®å¼€å‘ç»™æˆ‘ä»¬é€ æˆäº†ä¸€å®šçš„å›°æ‰°ï¼Œæˆ‘ä»¬å¦‚æœç”¨äº†ä¸¤ä¸ªæ¶ˆæ¯é˜Ÿåˆ—çš„å…¶ä¸­ä¸€ç§ï¼Œåé¢çš„ä¸šåŠ¡éœ€æ±‚ï¼Œæˆ‘æƒ³å¾€å¦å¤–ä¸€ç§æ¶ˆæ¯é˜Ÿåˆ—è¿›è¡Œè¿ç§»ï¼Œè¿™æ—¶å€™æ— ç–‘å°±æ˜¯ä¸€ä¸ªç¾éš¾æ€§çš„ï¼Œ<mark>ä¸€å¤§å †ä¸œè¥¿éƒ½è¦é‡æ–°æ¨å€’é‡æ–°åš</mark>ï¼Œå› ä¸ºå®ƒè·Ÿæˆ‘ä»¬çš„ç³»ç»Ÿè€¦åˆäº†ï¼Œè¿™æ—¶å€™springcloud Streamç»™æˆ‘ä»¬æä¾›äº†ä¸€ç§è§£è€¦åˆçš„æ–¹å¼ã€‚</p><ul><li><p>streamå‡­ä»€ä¹ˆå¯ä»¥ç»Ÿä¸€å·®å¼‚ï¼Ÿ</p><p>åœ¨æ²¡æœ‰ç»‘å®šå™¨è¿™ä¸ªæ¦‚å¿µçš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬çš„SpringBootåº”ç”¨è¦ç›´æ¥ä¸æ¶ˆæ¯ä¸­é—´ä»¶è¿›è¡Œä¿¡æ¯äº¤äº’çš„æ—¶å€™ï¼Œç”±äºå„æ¶ˆæ¯ä¸­é—´ä»¶æ„å»ºçš„åˆè¡·ä¸åŒï¼Œå®ƒä»¬çš„å®ç°ç»†èŠ‚ä¸Šä¼šæœ‰è¾ƒå¤§çš„å·®å¼‚æ€§é€šè¿‡å®šä¹‰ç»‘å®šå™¨ä½œä¸ºä¸­é—´å±‚ï¼Œå®Œç¾åœ°å®ç°äº†åº”ç”¨ç¨‹åºä¸æ¶ˆæ¯ä¸­é—´ä»¶ç»†èŠ‚ä¹‹é—´çš„éš”ç¦»ã€‚é€šè¿‡å‘åº”ç”¨ç¨‹åºæš´éœ²ç»Ÿä¸€çš„Channelé€šé“ï¼Œä½¿å¾—åº”ç”¨ç¨‹åºä¸éœ€è¦å†è€ƒè™‘å„ç§ä¸åŒçš„æ¶ˆæ¯ä¸­é—´ä»¶å®ç°ã€‚</p><p><mark>é€šè¿‡å®šä¹‰ç»‘å®šå™¨Binderä½œä¸ºä¸­é—´å±‚ï¼Œå®ç°äº†åº”ç”¨ç¨‹åºä¸æ¶ˆæ¯ä¸­é—´ä»¶ç»†èŠ‚ä¹‹é—´çš„éš”ç¦»ã€‚</mark></p><figure><img src="https://xcy-fcblog-1304336794.cos.ap-nanjing.myqcloud.com/posts/SpringCloud/image-20230617105633513.png" alt="image-20230617105633513" tabindex="0" loading="lazy"><figcaption>image-20230617105633513</figcaption></figure></li><li><p><mark>Binder</mark></p><figure><img src="https://xcy-fcblog-1304336794.cos.ap-nanjing.myqcloud.com/posts/SpringCloud/image-20230617105945547.png" alt="SpringCloudStreamå¤„ç†æ¶æ„" tabindex="0" loading="lazy"><figcaption>SpringCloudStreamå¤„ç†æ¶æ„</figcaption></figure><p>åœ¨æ²¡æœ‰ç»‘å®šå™¨è¿™ä¸ªæ¦‚å¿µçš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬çš„SpringBootåº”ç”¨è¦ç›´æ¥ä¸æ¶ˆæ¯ä¸­é—´ä»¶è¿›è¡Œä¿¡æ¯äº¤äº’çš„æ—¶å€™ï¼Œç”±äºå„æ¶ˆæ¯ä¸­é—´ä»¶æ„å»ºçš„åˆè¡·ä¸åŒï¼Œå®ƒä»¬çš„å®ç°ç»†èŠ‚ä¸Šä¼šæœ‰è¾ƒå¤§çš„å·®å¼‚æ€§ï¼Œé€šè¿‡å®šä¹‰ç»‘å®šå™¨ä½œä¸ºä¸­é—´å±‚ï¼Œ==å®Œç¾åœ°å®ç°äº†åº”ç”¨ç¨‹åºä¸æ¶ˆæ¯ä¸­é—´ä»¶ç»†èŠ‚ä¹‹é—´çš„éš”ç¦»ã€‚==Streamå¯¹æ¶ˆæ¯ä¸­é—´ä»¶çš„è¿›ä¸€æ­¥å°è£…ï¼Œå¯ä»¥åšåˆ°ä»£ç å±‚é¢å¯¹ä¸­é—´ä»¶çš„æ— æ„ŸçŸ¥ï¼Œç”šè‡³äºåŠ¨æ€çš„åˆ‡æ¢ä¸­é—´ä»¶(rabbitmqåˆ‡æ¢ä¸ºkafka)ï¼Œä½¿å¾—å¾®æœåŠ¡å¼€å‘çš„é«˜åº¦è§£è€¦ï¼ŒæœåŠ¡å¯ä»¥å…³æ³¨æ›´å¤šè‡ªå·±çš„ä¸šåŠ¡æµç¨‹</p><p><mark>é€šè¿‡å®šä¹‰ç»‘å®šå™¨Binderä½œä¸ºä¸­é—´å±‚ï¼Œå®ç°äº†åº”ç”¨ç¨‹åºä¸æ¶ˆæ¯ä¸­é—´ä»¶ç»†èŠ‚ä¹‹é—´çš„éš”ç¦»ã€‚</mark></p><p>Binderå¯ä»¥ç”ŸæˆBindingï¼ŒBindingç”¨æ¥ç»‘å®šæ¶ˆæ¯å®¹å™¨çš„ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…ï¼Œå®ƒæœ‰ä¸¤ç§ç±»å‹ï¼ŒINPUTå’ŒOUTPUTï¼ŒINPUTå¯¹åº”äºæ¶ˆè´¹è€…ï¼ŒOUTPUTå¯¹åº”äºç”Ÿäº§è€…ã€‚</p><p>Streamä¸­çš„æ¶ˆæ¯é€šä¿¡æ–¹å¼éµå¾ªäº†å‘å¸ƒ-è®¢é˜…æ¨¡å¼ï¼šTopicä¸»é¢˜è¿›è¡Œå¹¿æ’­</p><ul><li>åœ¨RabbitMQå°±æ˜¯Exchange</li><li>åœ¨Kakfaä¸­å°±æ˜¯Topic</li></ul><h4 id="spring-cloud-streamæ ‡å‡†æµç¨‹å¥—è·¯" tabindex="-1"><a class="header-anchor" href="#spring-cloud-streamæ ‡å‡†æµç¨‹å¥—è·¯" aria-hidden="true">#</a> Spring Cloud Streamæ ‡å‡†æµç¨‹å¥—è·¯</h4><figure><img src="https://xcy-fcblog-1304336794.cos.ap-nanjing.myqcloud.com/posts/SpringCloud/Spring Cloud Streamæ ‡å‡†æµç¨‹å¥—è·¯.png" alt="Spring Cloud Streamæ ‡å‡†æµç¨‹å¥—è·¯" tabindex="0" loading="lazy"><figcaption>Spring Cloud Streamæ ‡å‡†æµç¨‹å¥—è·¯</figcaption></figure><figure><img src="https://xcy-fcblog-1304336794.cos.ap-nanjing.myqcloud.com/posts/SpringCloud/image-20230618215733401.png" alt="image-20230618215733401" tabindex="0" loading="lazy"><figcaption>image-20230618215733401</figcaption></figure></li></ul><p>**Binderï¼š**å¾ˆæ–¹ä¾¿çš„è¿æ¥ä¸­é—´ä»¶ï¼Œå±è”½å·®å¼‚</p><p>**Channelï¼š**é€šé“ï¼Œæ˜¯é˜Ÿåˆ—Queueçš„ä¸€ç§æŠ½è±¡ï¼Œåœ¨æ¶ˆæ¯é€šè®¯ç³»ç»Ÿä¸­å°±æ˜¯å®ç°å­˜å‚¨å’Œè½¬å‘çš„åª’ä»‹ï¼Œé€šè¿‡Channelå¯¹é˜Ÿåˆ—è¿›è¡Œé…ç½®</p><p>**Sourceå’ŒSinkï¼š**ç®€å•çš„å¯ç†è§£ä¸ºå‚ç…§å¯¹è±¡æ˜¯Spring Cloud Streamè‡ªèº«ï¼Œä»Streamå‘å¸ƒæ¶ˆæ¯å°±æ˜¯è¾“å‡ºï¼Œæ¥å—æ¶ˆæ¯å°±æ˜¯è¾“å…¥ã€‚</p><p><strong>ç¼–ç APIå’Œå¸¸ç”¨æ³¨è§£ï¼š</strong></p><figure><img src="https://xcy-fcblog-1304336794.cos.ap-nanjing.myqcloud.com/posts/SpringCloud/image-20230618220351473.png" alt="ç¼–ç APIå’Œå¸¸ç”¨æ³¨è§£" tabindex="0" loading="lazy"><figcaption>ç¼–ç APIå’Œå¸¸ç”¨æ³¨è§£</figcaption></figure><h2 id="åäºŒã€springcloud-sleuthåˆ†å¸ƒå¼è¯·æ±‚é“¾è·¯è·Ÿè¸ª" tabindex="-1"><a class="header-anchor" href="#åäºŒã€springcloud-sleuthåˆ†å¸ƒå¼è¯·æ±‚é“¾è·¯è·Ÿè¸ª" aria-hidden="true">#</a> åäºŒã€SpringCloud Sleuthåˆ†å¸ƒå¼è¯·æ±‚é“¾è·¯è·Ÿè¸ª</h2><h3 id="_1ã€æ¦‚è¿°-4" tabindex="-1"><a class="header-anchor" href="#_1ã€æ¦‚è¿°-4" aria-hidden="true">#</a> 1ã€æ¦‚è¿°</h3></div><!----><footer class="page-meta"><!----><div class="meta-item git-info"><div class="update-time"><span class="label">ä¸Šæ¬¡ç¼–è¾‘äº: </span><!----></div><div class="contributors"><span class="label">è´¡çŒ®è€…: </span><!--[--><!--[--><span class="contributor" title="email: 1727195232@qq.com">Fu Chen</span><!--]--><!--]--></div></div></footer><!----><!----><!----><!--]--></main><!--]--><footer class="footer-wrapper"><div class="footer"><a href="https://beian.miit.gov.cn/#/Integrated/index">è±«ICPå¤‡2023001076å·-1</a></div><div class="copyright">Copyright Â© 2023 CY</div></footer></div><!--]--><!--]--><!----><!----><!--]--></div>
    <script type="module" src="/assets/app-40618983.js" defer></script>
  </body>
</html>
